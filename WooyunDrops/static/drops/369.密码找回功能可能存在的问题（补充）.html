<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">密码找回功能可能存在的问题（补充）</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">BMa</a> <span class="bull">·</span> <time title="2014/10/22 18:37" ui-time="" datetime="2014/10/22 18:37" class="published ng-binding ng-isolate-scope">2014/10/22 18:37</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h2>0x00 背景介绍</h2><hr><p>以前看了一片密码找回漏洞的总结，现在又看到了一些新的情况，写出来补充一下。</p><p>链接：<a href="http://drops.wooyun.org/papers/287">密码找回功能可能存在的问题</a></p><h2>0x01 回顾</h2><hr><p>上篇文章中已有的7点如下：</p><pre><code>1.  密码找回凭证太弱，容易被爆破
2.  密码找回凭证可以从客户端、URL中直接获取
3.  密码找回凭证可以在网页源代码中直接获取
4.  密码找回的邮箱链接易猜解，如时间的md5
5.  密码找回凭证存并非只是与单个用户并绑定的问题。
6.  密码找回的手机或邮箱从页面获取，可以通过firebug修改
7.  最后提交新密码时修改用户ID为其他ID
</code></pre><h2>0x02 补充</h2><hr><p>一. 跳过验证步骤、找回方式，直接到设置新密码页面</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-042404">WooYun: OPPO手机同步密码随意修改，短信通讯录随意查看</a></p><p>二. 找回密码时没有在服务器上验证用户名与邮箱是否匹配便发送了验证码</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-078208">WooYun: 魅族的账号系统内存在漏洞可导致任意账户的密码重置</a></p><p>http://www.zhaojin97.cn/read-196.html</p><p>三. 重置密码时返回的token没有与账号以及验证码绑定</p><p>还是上面的魅族密码重置问题</p><p>四. 服务器只验证了对应的验证信息是否存在，没有验证是否与账号匹配</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-053349">WooYun: OPPO手机重置任意账户密码（3）</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-053079">WooYun: 第二次重置OPPO手机官网任意账户密码（秒改）</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-020032">WooYun: OPPO修改任意帐号密码</a></p><p>五. 在本地验证服务器的返回信息，确定是否执行重置密码，但是其返回信息是可控的内容，或者可以得到的内容</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-069987">WooYun: oppo重置任意用户密码漏洞(4)</a></p><p>六. 发送短信等验证信息的动作在本地进行，可以通过修改返回包进行控制</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-020532">WooYun: OPPO修改任意帐号密码-3</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-020425">WooYun: OPPO修改任意帐号密码-2</a></p><p>七. 提交新密码时的，只验证了部分可控的信息是否匹配</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-080278">WooYun: AA拼车网之任意密码找回2</a></p><p>八. 在找回密码处存在注入漏洞</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-068060">WooYun: 用友人力资源管理软件（e-HR）另一处SQL注入漏洞（通杀所有版本）</a></p><h2>0x03 修复方案</h2><hr><p>找回密码凭证够复杂并且不可猜测，任何动作放在服务器端进行，传输的验证参数做好加密，同时对参数做好过滤</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/web/5048" rel="bookmark" id="re1">密码找回逻辑漏洞总结</a></li><li><a href="http://drops.wooyun.org/papers/287" rel="bookmark" id="re2">密码找回功能可能存在的问题</a></li><li><a href="http://drops.wooyun.org/papers/346" rel="bookmark" id="re3">终端机的安全性</a></li><li><a href="http://drops.wooyun.org/papers/345" rel="bookmark" id="re4">在线支付逻辑漏洞总结</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">贾昌需</span> <span class="reply-time">2016-05-07 17:52:26</span></div><p></p><p>我的QQ密码忘了。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">hack2012</span> <span class="reply-time">2014-11-07 12:29:23</span></div><p></p><p>很强大。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">depycode</span> <span class="reply-time">2014-10-23 15:27:54</span></div><p></p><p>Do intercept =&gt; Response to this request 好东西。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">BMa</span> <span class="reply-time">2014-10-23 14:26:53</span></div><p></p><p>可以看到时间跨度比较大，几个都是补了被挖出来，再补，又被挖出来，有代表性而已</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">BMa</span> <span class="reply-time">2014-10-23 14:25:34</span></div><p></p><p>有些确实是放在客户端通过response来判断，都是问题</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">hkAssassin</span> <span class="reply-time">2014-10-23 09:36:36</span></div><p></p><p>这个问题现在很多……</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">李白</span> <span class="reply-time">2014-10-22 21:46:45</span></div><p></p><p>还遇到过提交后返回response，根据response的true false来判断是否进入下一步重置的</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">F1uYu4n</span> <span class="reply-time">2014-10-22 19:51:11</span></div><p></p><p>这么多oppo。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">RainShine</span> <span class="reply-time">2014-10-22 19:15:03</span></div><p></p><p>嗯，讲得好。</p><p></p></div></div></div></div></div></main>