<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">WordPress更新至 3.8.2 修复多个漏洞</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">news</a> <span class="bull">·</span> <time title="2014/04/11 17:46" ui-time="" datetime="2014/04/11 17:46" class="published ng-binding ng-isolate-scope">2014/04/11 17:46</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><p><img alt="enter image description here" img-src="959bc13deaa384c1cb5e2bb5d832f11b0c3a95dd.jpg"></p><p>在被OpenSSL刷屏的时候，WordPress更新。</p><p>WordPress 3.8.2现在已经提供下载，最新的版本更新了几个重要的安全问题，所以推荐更新。</p><p>WordPress 3.8.2修复的一个重要漏洞是cookie伪造漏洞（<a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-0166">CVE -2014- 0166</a>）。该漏洞可以被攻击者利用通过伪造身份验证Cookie，登陆网站。该漏洞是由WordPress的安全团队成员<a href="http://joncave.co.uk/">Jon Cave</a>发现。</p><p>第二个漏洞是权限提升（CVE -2014- 0165）漏洞，可以使投稿人角色发布文章。</p><p>还有<a href="https://security.dxw.com/advisories/sqli-in-wordpress-3-6-1/">后台注入漏洞</a>，以及在上传文件处使用第三方库导致的xss漏洞。</p><p>注入漏洞修改代码：<a href="https://core.trac.wordpress.org/changeset/27917">https://core.trac.wordpress.org/changeset/27917</a></p><p>是一个二次注入。</p><p>cookie伪造修复wp-includes/pluggable.php文件中：</p><p><a href="https://github.com/WordPress/WordPress/commit/7f001bfe242580eb18f98e2889aad4ab1b33301b">https://github.com/WordPress/WordPress/commit/7f001bfe242580eb18f98e2889aad4ab1b33301b</a></p><pre><code>#!diff
    $key = wp_hash($username . $pass_frag . '|' . $expiration, $scheme);
    $hash = hash_hmac('md5', $username . '|' . $expiration, $key);

 -  if ( $hmac != $hash ) {
 +  if ( hash_hmac( 'md5', $hmac, $key ) !== hash_hmac( 'md5', $hash, $key ) ) {
</code></pre><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/papers/1409" rel="bookmark" id="re1">WordPress 3.8.2 cookie伪造漏洞再分析</a></li><li><a href="http://drops.wooyun.org/papers/1404" rel="bookmark" id="re2">WordPress 3.8.2补丁分析 HMAC timing attack</a></li><li><a href="http://drops.wooyun.org/papers/9510" rel="bookmark" id="re3">WordPress 利用 XMLRPC 高效爆破 原理分析</a></li><li><a href="http://drops.wooyun.org/news/1062" rel="bookmark" id="re4">超过16W的WordPress网站被用来做DDoS攻击</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">test</span> <span class="reply-time">2014-05-07 12:39:20</span></div><p></p><p>mark</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小贱人</span> <span class="reply-time">2014-05-07 11:52:33</span></div><p></p><p>mark</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2014-04-12 21:07:09</span></div><p></p><p>其实在另一个地方还有个类似洞</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xDo</span> <span class="reply-time">2014-04-12 18:36:35</span></div><p></p><p>好吧，才發完我就懂了，撤回</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xDo</span> <span class="reply-time">2014-04-12 18:30:58</span></div><p></p><p>昨天想了一天沒想通這個點為什麼會有cookie forge<br>沒有auth_key和auth_salt一樣造不出cookie呀<br>哪位大牛科普下怎麼forge，修復代碼再來一次hash_hmac又有什麼用？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Haswell</span> <span class="reply-time">2014-04-12 11:39:44</span></div><p></p><p>0 0</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">思尼克</span> <span class="reply-time">2014-04-12 01:00:47</span></div><p></p><p>洞察力</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">我是壮丁</span> <span class="reply-time">2014-04-11 20:04:13</span></div><p></p><p>mark</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xx</span> <span class="reply-time">2014-04-11 19:16:31</span></div><p></p><p>xx</p><p></p></div></div></div></div></div></main>