<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">账号安全之扫号</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">小胖胖要减肥</a> <span class="bull">·</span> <time title="2014/05/26 12:55" ui-time="" datetime="2014/05/26 12:55" class="published ng-binding ng-isolate-scope">2014/05/26 12:55</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h2>0x00 背景</h2><hr><p>何为扫号（黑产术语），通俗讲就是拿别人网站的数据库，尝试当前想要破解用户账户的网站。</p><p>自从csdn的明文600万，到猫扑，天涯，多玩，7k7k等陆续爆出密码，扫号大军慢慢从地下逐步显现出来。已然成为当前账户安全的第一大杀手。没错，是第一。</p><p>诚然支付宝数据库再严密，也无法抵挡账户被扫的命运。</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-037984">WooYun: 支付宝某接口存在安全隐患可被利用撞库(有证明)！</a></p><p>诚然京东没有显示被脱裤，也无奈放出扫号账号密码对其的一番炒作。</p><p><a href="http://drops.wooyun.org/news/989">京东数据库泄露事件分析</a></p><p>那么对于用户和开发者，对扫号有好的办法吗？</p><h2>0x01 防御</h2><hr><p>对于用户而言，最好每个网站密码不同，当然这个需要极高的安全意识，和良好的用户习惯。</p><p>比如京东账号在原有密码前可以加jd，或者在后面加。支付宝可以加zfb等方式。</p><p>对于开发者而言，又有什么好办法呢？ 首先要开发者要意识到，道高一尺，魔高一丈。扫号问题是2方的不断比拼，下面从基本的几个地方对于开发者进行一个普及。</p><pre><code>1 完全无验证码，且ip访问无限制。
2 密码输入错误几次出现验证码，但是对于不断更换账号登陆即不会出现验证码
3 页面不刷新验证码无限次使用
4 判断用户cookies某值是否访问过，只要请求不带cookies就能绕过
5 主站有验证码，但是wap，移动客户端都没有，直接通过拦截请求可绕过
6 https对防扫号基本无用，只是传输加密
</code></pre><p>以上几点只是抛砖引玉，逻辑漏洞开发人员尽量避免。扫号无非就是通过如下几点来达到验证账户的目的。</p><pre><code>1 无验证码和访问限制直接扫号
2 通过逻辑漏洞绕过已有验证码策略扫号
3 控制时间频度扫号
4 不断更换ip进行扫号
5 识别验证码进行扫号
</code></pre><p>开发者在防御上也可以基于上面几点。</p><p>下面介绍某大型电商网站的一个例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-044897">WooYun: 电商普及型安全-美团扫号篇(接口设计不当)</a></p><p>希望能对用户和开发者警示。（电商账户被盗事件相信都已进入大伙视线）</p><p>某大型电商网站某接口没有做限制，无验证码（当然单个账号错误几次后有）</p><p><img alt="enter image description here" img-src="feecc6f928ecb3caaced9bcf55cb51043c82b67d.jpg"></p><p>某工具参数化后发现不少账号密码已经成功</p><p><img alt="enter image description here" img-src="43440e5de974e0a7acca7c67374f24ffdb1b07e9.jpg"></p><p>登陆尝试可以登陆</p><p><img alt="enter image description here" img-src="d35e4d0d89f18c3be0b839ddc169e2459a24562e.jpg"></p><p>希望不管还是用户，开发都能够看完此篇后，对于账户安全有一定重视，没有2方的共同努力，安全都是空谈，就好比用户密码都用排名前10的如123456，520520。安全的建设也需要用户的共同进步。</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/papers/2035" rel="bookmark" id="re1">一些常见的重置密码漏洞分析整理</a></li><li><a href="http://drops.wooyun.org/papers/741" rel="bookmark" id="re2">电商网站的安全性</a></li><li><a href="http://drops.wooyun.org/tips/139" rel="bookmark" id="re3">浅谈大型互联网的安全</a></li><li><a href="http://drops.wooyun.org/papers/506" rel="bookmark" id="re4">[代码审计]web程序对客户端数据加解密带来的安全问题</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">李旭敏</span> <span class="reply-time">2015-03-18 14:56:19</span></div><p></p><p>楼主太短了···</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">黑吃黑</span> <span class="reply-time">2014-09-28 12:47:34</span></div><p></p><p>大哥，能把怎么用工具，写详细点吗</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">wangy3e</span> <span class="reply-time">2014-08-24 22:19:43</span></div><p></p><p>太easy了,还有干货么</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">HackBraid</span> <span class="reply-time">2014-08-19 21:45:13</span></div><p></p><p>结合看了下，赞！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">se55i0n</span> <span class="reply-time">2014-06-12 20:01:47</span></div><p></p><p>哈哈，丢点裤子上来，占下篇幅~</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">风萧萧</span> <span class="reply-time">2014-06-02 08:30:24</span></div><p></p><p>就没了？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">F4K3R</span> <span class="reply-time">2014-05-28 17:45:42</span></div><p></p><p>Thx! 感觉楼主泄漏自己密码习惯了。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小贱人</span> <span class="reply-time">2014-05-28 17:09:21</span></div><p></p><p>已阅</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xiaoL</span> <span class="reply-time">2014-05-28 16:16:30</span></div><p></p><p>没有2方的共同努力...- -<br>高级黑啊...<br>科普了...</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">zzR</span> <span class="reply-time">2014-05-28 08:33:34</span></div><p></p><p>mark 阅读: 1,000</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Bloodwolf</span> <span class="reply-time">2014-05-27 19:49:47</span></div><p></p><p>撞裤，主要有验证码就不用 BP了。直接用自定义API打码接口，当然前提是搞下来有money赚！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">动后河</span> <span class="reply-time">2014-05-26 23:27:04</span></div><p></p><p>某工具看上去版本很低啊，我都1.6破解版了。<br>“我下次整个yy的”，已经放出话了，多玩要注意了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">饭粒重生</span> <span class="reply-time">2014-05-26 21:41:27</span></div><p></p><p>干货要多放点啊。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">郭斯特</span> <span class="reply-time">2014-05-26 18:55:03</span></div><p></p><p>短……不过很赞~</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">px1624</span> <span class="reply-time">2014-05-26 16:51:20</span></div><p></p><p>好短</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">瞌睡龙</span> <span class="reply-time">2014-05-26 16:34:08</span></div><p></p><p>这周内吧，挤一挤就有了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小胖胖要减肥</span> <span class="reply-time">2014-05-26 15:42:08</span></div><p></p><p>我下次整个yy的</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">瞌睡龙</span> <span class="reply-time">2014-05-26 12:56:33</span></div><p></p><p>货不够干，等作者多发一些策略 :)</p><p></p></div></div></div></div></div></main>