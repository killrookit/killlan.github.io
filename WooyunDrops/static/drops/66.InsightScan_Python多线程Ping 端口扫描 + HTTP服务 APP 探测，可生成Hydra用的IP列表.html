<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">InsightScan:Python多线程Ping/端口扫描 + HTTP服务/APP 探测，可生成Hydra用的IP列表</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">insight-labs</a> <span class="bull">·</span> <time title="2013/08/10 19:19" ui-time="" datetime="2013/08/10 19:19" class="published ng-binding ng-isolate-scope">2013/08/10 19:19</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><p>现成的工具没一个好用的，包括metasploit自带的模块。本扫描器支持CIDR格式输入IP地址段，支持任意线程扫描，支持自定义端口列表或端口段，可以自动在开了常见HTTP服务的端口把网页内容抓下来，并且判断并提示一些重要管理应用。可以将扫描结果按照端口号来生成不同的文件，方便测试弱密码。</p><p>使用说明：</p><pre><code>Usage: InsightScan.py &lt;hosts[/24|/CIDR]&gt; [start port] [end port] -t threads

Example: InsightScan.py 192.168.0.0/24 1 1024 -t 20
</code></pre><pre><code>Options:
-h, –help show this help message and exit
-t NUM, –threads=NUM
Maximum threads, default 50
-p PORTS, –portlist=PORTS
Customize port list, separate with ‘,’ example:21,22,23,25 …
-N, –noping Skip ping sweep, port scan whether targets are alive or not
-P, –pingonly Ping scan only,disable port scan
-d, –downpage Download and save HTML pages from HTTP ports(80,81,8080), also detects some web apps
-l, –genlist Output a list, ordered by port number,for THC-Hydra IP list
-L, –genfile Put the IP list in separate files named by port number. 
Implies -l option. Example: IPs with port 445 opened will be put into 445.txt
</code></pre><p>中文说明：</p><pre><code>-t 最大扫描线程数，默认50
-p 自定义端口列表，用逗号分隔，例如 -p 21,23,25,80 也可以只设定一个端口, -p 445
默认端口列表为21,22,23,25,80,81,110,135,139,389,443,445,873,1433,1434,1521,2433,3306,3307,3389,5800,5900,8080,22222,22022,27017,28017
-N 不ping直接扫描，相当于nmap的 -Pn选项，会比较慢
-P 不扫描端口，只进行ping扫描 判断存活主机
-d 在 80，81，8080端口检测 HTTP服务器，并且扫描一些常见web应用，比如：’phpinfo.php’,'phpmyadmin/’,'xmapp/’,'zabbix/’,'jmx-console/’,’.svn/entries’,'nagios/’,'index.action’,'login.action’
</code></pre><p>用途大家自己想……</p><p>如需添加，改源码里的URLS全局变量，目录名后面必须加’/’</p><p>检测到这些应用存在后会在输出提示并且把HTML抓下来保存到page.html文件里。</p><p>-l 把扫描结果按照端口号分类后输出，只有在完全扫描完成后才会输出，输出：</p><pre><code>========Port 3306 ========
192.168.0.100

========Port 139 ========
192.168.0.100
192.168.0.13

========Port 3389 ========
192.168.0.100

========Port 80 ========
192.168.0.100
192.168.0.1

========Port 23 ========
192.168.0.1

========Port 443 ========
192.168.0.13

========Port 445 ========
192.168.0.100
192.168.0.13
</code></pre><p>-L 按照不同端口号生成以端口号命名的txt文件，文件内容是打开该端口的IP列表。</p><p>例如 在192.168.0.0/24 扫描22和445端口。</p><p>扫描结束后会在当前目录生成 22.txt和 445.txt，里面是这个ip段所有打开这两个端口的ip列表。</p><p>生成的列表文件可以直接供THC-hydra的 -M 选项使用。</p><p><a href="http://static.wooyun.org/20141017/2014101712315635083.zip">下载地址</a></p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/tips/6653" rel="bookmark" id="re1">使用sqlmapapi.py批量化扫描实践</a></li><li><a href="http://drops.wooyun.org/tips/4333" rel="bookmark" id="re2">Nmap速查手册</a></li><li><a href="http://drops.wooyun.org/tips/2504" rel="bookmark" id="re3">Burp Suite使用介绍（四）</a></li><li><a href="http://drops.wooyun.org/papers/12645" rel="bookmark" id="re4">中间人攻击 -- Cookie喷发</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">big、face</span> <span class="reply-time">2014-02-12 10:24:14</span></div><p></p><p>python 2.7.5好像跑不了啊？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">HRay</span> <span class="reply-time">2013-12-01 21:50:08</span></div><p></p><p>如果开放web的建议获取相关title信息，方便快速判断，很多情况根据端口访问的可能都是403，或者一个webserver的初始页面而已</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">中国公民</span> <span class="reply-time">2013-08-21 14:32:30</span></div><p></p><p>亲测可用，特登录帐号表示感谢。</p><p>-n参数挺不错的。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Vty</span> <span class="reply-time">2013-08-20 14:29:58</span></div><p></p><p>你在群里吗？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2013-08-15 23:42:23</span></div><p></p><p>已经更新，加入了端口服务探测的功能，支持大部分在渗透中有用的服务，把再也不怕狡猾的管理员把ssh和3389改端口了。</p><p>详情请见http://insight-labs.org/?p=981<br>github:<br>https://github.com/AnthraX1/InsightScan</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">tmp</span> <span class="reply-time">2013-08-15 18:51:23</span></div><p></p><p>其实..nmap真的不好用..出名.是因为他是老牌scanner而已..所以.不少人都用自己写的scanner</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Ivan</span> <span class="reply-time">2013-08-15 16:43:17</span></div><p></p><p>感觉比nmap好用些</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">tmp</span> <span class="reply-time">2013-08-15 15:51:31</span></div><p></p><p>做scanner 纯粹是体力活. 捉包 + funtion ...捉包 + funtion....只要有新的东西出来,就继续捉继续+function</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2013-08-14 19:50:03</span></div><p></p><p>就是为了内网渗透写的，在开发更新版，会加上端口服务指纹识别的功能，即使把服务开到特殊端口也能发现。还有就是会加上一些针对特殊web应用的初步安全检测。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">健宇</span> <span class="reply-time">2013-08-14 18:53:09</span></div><p></p><p>这个东西不错，内网渗透非常好。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2013-08-12 11:19:31</span></div><p></p><p>= =这个忘了，自己改下代码吧，很简单的。<br>有空我放到github上面</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">二少</span> <span class="reply-time">2013-08-12 11:04:26</span></div><p></p><p>能不能在加上状态吗401呀。401是个好东西噻。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2013-08-12 11:00:57</span></div><p></p><p>目前应该能在python &gt; 2.6的环境下用，2.4-2.5的queue没有join()方法，运行会出错，不过改一个2.4的出来也很快</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2013-08-12 10:59:32</span></div><p></p><p>insightscan.py 192.168.0.1 1 65535 -t 128<br>128线程扫1-65535，局域网内一分钟不到搞定</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">二少</span> <span class="reply-time">2013-08-12 10:50:25</span></div><p></p><p>如果能加上一个参数 可以从1-65535 全面扫就感觉完美了。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2013-08-12 10:40:31</span></div><p></p><p>很纯洁的基友关系……<br>nmap是很强大，但是也臃肿，能用nmap我肯定还是用nmap的。这个脚本虽然功能简单，但是总结了很多内网渗透的经验教训后写出来的，以后还会不断更新的。代码没版权随便改。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">livers</span> <span class="reply-time">2013-08-12 10:25:28</span></div><p></p><p>@insight-labs 你和瞌睡龙是啥关系啊，说出来 给你写一个功能一样nmap的lua 脚本。</p><p></p></div></div></div></div></div></main>