<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">拆分密码</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">路人甲</a> <span class="bull">·</span> <time title="2015/11/26 10:36" ui-time="" datetime="2015/11/26 10:36" class="published ng-binding ng-isolate-scope">2015/11/26 10:36</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h1>0x00 研究范围</h1><hr><ul><li>在WEB渗透中可能使用某个关键字为密码核心的密码(Mail,Vpn,后台登陆等)</li></ul><h1>0x01 实际数据分析</h1><hr><ul><li>Gmail 500W明文密码</li><li>个人以往渗透实例</li><li>美国姓名top2000</li></ul><p><strong>在以往的渗透过中发现绝大多数企业的web服务是不允许注册，都是由某个人或系统分配的，而在这之中又有大部分的分配是人为分配，这就引出了我今天研究的主题《拆分密码》。</strong></p><p><strong>人们在分配密码的时候是无法做到计算机那样随机的。多数都是根据某个关键字加上一些字符如企业名，时间，123等，这样的分配方式就给密码赋予了结构</strong></p><h1>0x02 密码结构</h1><ul><li><strong>前缀</strong></li><li><strong>关键字</strong></li><li><strong>连接符</strong></li><li><strong>后缀</strong></li></ul><p><img alt="Alt Text" img-src="c22812c79399890c91dbc5a398b2dccd7840c241.jpg"></p><h3>1.)关键字</h3><p>以drops.wooyun.org为例子</p><ul><li><strong>URL (二级域名,跟域名)</strong><ul><li>keyword=[drop,wooyun,wooyun.org]</li></ul></li><li><strong>域名注册信息 (邮件,姓名,时间)</strong><ul><li>keyword=[xssshell,fangxiaodun，20100506]</li></ul></li><li><strong>网站内容 （标题,关键字,页脚)</strong><ul><li>keyword=[WooYun,zhishiku,Security,exploits,hacker,0day,pentest]</li></ul></li><li><strong>常用密码关键字</strong><ul><li>keyword=[admin,manage,pass,姓名top500]</li></ul></li></ul><p>收集网页内容关键字小脚本，对中文站没什么效果.这里以www.megacorpone.com为例子，我也是看了这个站点的渗透测试报告才触发我写这篇文章</p><pre><code><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="ccbea3a3b88c81a8">[email&#160;protected]</a>:wget www.megacorpone.com -O 1.html
<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="cab8a5a5be8a87ae">[email&#160;protected]</a>:cat 1.html|tr ' ' '\n'|grep '^[0-9a-Z]*[0-9a-Z]$'|sort|uniq|
</code></pre><p><img alt="Alt Text" img-src="499d976d6ef1dc9c5cb4bead2d645a7eb09c06df.jpg"></p><p><strong>当然也有现成工具 cewl</strong></p><p><img alt="Alt Text" img-src="97a4a3c0285375ac158d7c2fd9b2a12fd83cea9e.jpg"></p><h3>2.)前缀与后缀</h3><p>在Gmail 500W明文密码中，我用邮件名作为关键字进行分析：</p><ul><li>500W密码中有11561条密码是用用户名做关键字且排除了用户名为密码和用户名重复为密码。</li><li>11561条密码中有791条是前缀加关键字的模式</li></ul><p><img alt="Alt Text" img-src="84bf11c6f3b55e9c79f1a542e896357b0516ac92.jpg"></p><ul><li>11561条密码中有2308条是前缀加关键字加链接符加后缀的模式</li></ul><p><img alt="Akt Text" img-src="689faf56f9f2d410980f90629a650b9ca65b19c1.jpg"></p><ul><li>11561条密码中有8462条是关键字加后缀的模式</li></ul><p><img alt="Alt Text" img-src="656e2937fb85dcaf4cfc07ce8fa4b7b7f7341cd6.jpg"></p><p>从上面的数据可以分析出，前缀加关键字加链接符加后缀的模式最少，值得我们注意的的是oliver+关键字+@+gmail.com这个模式，很经典。前缀和后缀中使用最多的1和123,前缀中值得注意的是iam，big,the，大多数前缀都使用的名词或者短语，<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="32d7a2bcd58eb2d7b28ed78ca5d4819ad4b6bdd5a8b6d4aa9d72555f535b5e1c515d5f">[email&#160;protected]</a>,<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="59bcc5f1bde2fcbce7d9bcf6dfbef9d8bed5c5b1fefabde1f4bce7d1bcfdc3bde5d8bde1c3b0dbf7bef7e8bec3ddb0e2c1b1f7fdbcf6dfbef9d8bce9e8bfc1f6bcfe">[email&#160;protected]</a><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="0de89d80eb86b1e492bee887ade9b587e49eb3eb83a8eaa1ab4de887ade9b587e89292e89d80e9b091e9b5b7e89d83eab18d">[email&#160;protected]</a></p><p><strong>那么问题就来了，为什么是它们?</strong></p><p>在我的研究中，我将前缀和后缀分为4个类型:</p><ul><li>连续性 字符连续的递增</li><li>重复性 字符重复</li><li>规则性 利用字符体现某种规则<ul><li>键盘规则</li><li>寓意规则</li></ul></li><li>应付性 满足系统强制要求</li></ul><p>单个字符前缀全部看做是 应付性，而没有意义的东西人们往往很难记忆，所以在应付性的情况下会选择规则性帮助记忆。10个数字26字母32个符号一共68个字符</p><pre><code>1234567890
qwertyuiopasdfghjklzxcvbnm
</code></pre><ul><li>键盘的设计是根据人体工程学设计的，最方便的键就是使用频率最高的键。玩过魔兽世界中pve无脑冰法的应该知道，【寒冰箭】基本都放数字1键，因为在抛弃字母键后，无名指按1键最方便，且连续按下123也最快捷。所以在 应付性 下满足系统要求（密码不为纯数字或纯字符）以字母做为关键字的密码，单数字前缀概率最大的为1</li><li>寓意规则 1(最大）,6(顺的寓意）,8（发的寓意）</li><li>键盘规则 ①中档键>右手>食指 J</li><li>寓意规则 以名字首字母为寓意 A</li></ul><p><img alt="Alt Text" img-src="eb1eec9df1d50f99b890ccfea1dabe70b663c80e.jpg"></p><pre><code>~!@#$%^&amp;*()-_=+[{]}\|;:'",&lt;.&gt;/?
</code></pre><ul><li>键盘规则 在输出字符的时候需要按住Shift键<ul><li>左手小指按Shift键 _</li><li>左手大拇指按Shift键 ！</li></ul></li><li>寓意规则 @ 像a,邮件代表符号，易记忆</li></ul><p><strong>多个字符我们用 连续性 重复性 规则性分析</strong></p><ul><li>连续性 连续性字符大于2位，小于等于6位<ul><li>123,abc,!@#</li></ul></li><li>重复性 重复性字符串大于1位小于等于3位<ul><li>888,qq,..</li></ul></li><li>规则性<ul><li>键盘规则<ul><li>qwe,147</li></ul></li><li>寓意规则<ul><li>woshi,520,@))*，名词top100,短语top100<ul><li>@））* == shift（2008）</li></ul></li></ul></li></ul></li></ul><h3>3.）链接符</h3><p>链接符不一定存在，弱存在只为一个单符号</p><ul><li>@ 寓意规则</li><li>_ 应付性</li><li>&amp; 键盘规则</li></ul><p>前缀和后缀是有区别的，像woshi更应该做为前缀，qwe，888应该做为后缀,前缀可以为空，链接符可以为空，后缀可以为空</p><p><img alt="Alt Text" img-src="72403184bd1eb06eabb2b5ead03f8a94e78702bd.jpg"></p><h3>4.)组合方式</h3><ul><li>前缀+关键字<ul><li>前缀多应付性和寓意性</li></ul></li><li>前缀+关键字+链接符+后缀<ul><li>关键字多为寓意性</li></ul></li><li>关键字+后缀<ul><li>ALL</li></ul></li><li>关键字+链接符+后缀<ul><li>后缀多为键盘规则和连续性</li></ul></li></ul><h1>0x02 总结</h1><hr><p><strong>一切非随即密码都是为了方便记忆，现在爆破的核心不是弱密码，而是使用有规则密码的弱用户。人是懒惰的，为了方便记忆会将自己的记忆做为密码记忆。</strong></p><p>注①：《电脑键盘字母的优化排列》 这篇文章仅仅是我写社工字典程序的理论框架，如果有与科学理论违背的地方，以科学理论为主</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/tips/5253" rel="bookmark" id="re1">劫持SSH会话注入端口转发</a></li><li><a href="http://drops.wooyun.org/tips/413" rel="bookmark" id="re2">CentOS 6.2下安装基于Suricata + Barnyard 2 + Base 的⼊侵检测系统</a></li><li><a href="http://drops.wooyun.org/papers/653" rel="bookmark" id="re3">搭建基于Suricata+Barnyard2+Base的IDS前端Snorby</a></li><li><a href="http://drops.wooyun.org/tips/2591" rel="bookmark" id="re4">Python教程WEB安全篇</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">王松_Striker</span> <span class="reply-time">2016-04-07 19:14:22</span></div><p></p><p>666 牛逼！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">八六子。</span> <span class="reply-time">2016-02-17 22:36:41</span></div><p></p><p>好文</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">情痴</span> <span class="reply-time">2015-12-17 11:27:13</span></div><p></p><p>学习了，谢谢分享</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">bfish</span> <span class="reply-time">2015-12-16 16:11:16</span></div><p></p><p>没想到有人写文章了，不过我的那个分词法，前提需要有一定的基础数据，然后将社工库里的密码进行分解训练，其实这个还可以进行推算。定义一类人设置这一类人密码习惯，利用社工库查询这个人是否数据这一类，然后通过这一类人的密码习惯生成规则，生成这个人可能存在的潜在密码。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">麦兜</span> <span class="reply-time">2015-11-30 19:03:43</span></div><p></p><p>@Knight 6666 这是用了多久的abc</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Knight</span> <span class="reply-time">2015-11-30 16:44:43</span></div><p></p><p>由此可知这篇文章使用拼音输入法敲的。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Knight</span> <span class="reply-time">2015-11-30 16:44:08</span></div><p></p><p>一切非随即密码都是为了方便记忆<br>错别字：随即-》随机</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">扬帆大海</span> <span class="reply-time">2015-11-26 14:42:24</span></div><p></p><p>一切有人参与的系统，其最大的弱点都是人类自身。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">1</span> <span class="reply-time">2015-11-26 12:42:44</span></div><p></p><p>是克里斯托夫·拉森·肖尔斯（Christopher Latham Sholes）解决了这个问题，他发明了QWERTY键盘的布局，他将最常用的几个字母安置在相反方向，以此最大限度放慢打字时敲键速度，从而避免卡键。<br>措词修改下就好……</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">justforfun</span> <span class="reply-time">2015-11-26 12:31:40</span></div><p></p><p>好文！</p><p></p></div></div></div></div></div></main>