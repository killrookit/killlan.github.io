<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">密码找回逻辑漏洞总结</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">BMa</a> <span class="bull">·</span> <time title="2015/03/09 10:48" ui-time="" datetime="2015/03/09 10:48" class="published ng-binding ng-isolate-scope">2015/03/09 10:48</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h1>0x00 背景介绍</h1><hr><p>请注意这两篇文章：</p><p><a href="http://drops.wooyun.org/papers/287">密码找回功能可能存在的问题</a></p><p><a href="http://drops.wooyun.org/web/3295">密码找回功能可能存在的问题（补充）</a></p><p>距离上两篇文档过去近半年了，最近整理密码找回的脑图，翻开收集的案例，又出现了一些新的情况，这里一并将所有见到的案例总结并分享给大家，在测试时可根据这个框架挖掘！</p><h1>0x01 密码找回逻辑测试一般流程</h1><hr><ul><li>首先尝试正常密码找回流程，选择不同找回方式，记录所有数据包</li><li>分析数据包，找到敏感部分</li><li>分析后台找回机制所采用的验证手段</li><li>修改数据包验证推测</li></ul><h1>0x02 脑图</h1><hr><p><img alt="enter image description here" img-src="24e32badc27ba9c0a4e89ec008806bed9e593ef3.jpg"></p><h1>0x03 详情</h1><hr><h2>用户凭证暴力破解</h2><hr><p>四位或者六位的纯数字 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-011833">WooYun: 当当网任意用户密码修改漏洞</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-011720">WooYun: 微信任意用户密码修改漏洞</a></p><h2>返回凭证</h2><hr><p>url返回验证码及token 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-05630">WooYun: 走秀网秀团任意密码修改缺陷</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-058210">WooYun: 天天网任意账户密码重置（二）</a></p><h2>密码找回凭证在页面中</h2><hr><p>通过密保问题找回密码 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-04728">WooYun: sohu邮箱任意用户密码重置</a></p><h2>返回短信验证码</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-085124">WooYun: 新浪某站任意用户密码修改（验证码与取回逻辑设计不当）</a></p><h2>邮箱弱token</h2><hr><p>时间戳的md5 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-08333">WooYun: 奇虎360任意用户密码修改漏洞</a></p><h2>用户名 &amp; 服务器时间</h2><hr><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2015-090226">WooYun: 中兴某网站任意用户密码重置漏洞（经典设计缺陷案例）</a></p><h2>用户凭证有效性</h2><hr><p>短信验证码 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-053349">WooYun: OPPO手机重置任意账户密码（3）</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-053079">WooYun: 第二次重置OPPO手机官网任意账户密码（秒改）</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-020032">WooYun: OPPO修改任意帐号密码</a></p><h2>邮箱token</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-012572">WooYun: 身份通任意密码修改-泄漏大量公民信息</a></p><h2>重置密码token</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-078208">WooYun: 魅族的账号系统内存在漏洞可导致任意账户的密码重置</a></p><h2>重新绑定</h2><hr><p>手机绑定 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-08307">WooYun: 网易邮箱可直接修改其他用户密码</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-081467">WooYun: 12308可修改任意用户密码</a></p><h2>邮箱绑定</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2015-092319">WooYun: 某彩票设计缺陷可修改任意用户密码</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-086726">WooYun: 中国工控网任意用户密码重置漏洞</a></p><h2>服务器验证</h2><hr><p>最终提交步骤 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-018263">WooYun: 携程旅行网任意老板密码修改(庆在wooyun第100洞)</a></p><h2>服务器验证可控内容</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-080278">WooYun: AA拼车网之任意密码找回2</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-082582">WooYun: 四川我要去哪517旅行网重置任意账号密码漏洞</a></p><h2>服务器验证验证逻辑为空</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-088927">WooYun: 某政企使用邮件系统疑似存在通用设计问题</a></p><h2>用户身份验证</h2><hr><p>账号与手机号码的绑定</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-075941">WooYun: 上海电信通行证任意密码重置</a></p><h2>账号与邮箱账号的绑定</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-078208">WooYun: 魅族的账号系统内存在漏洞可导致任意账户的密码重置</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2015-091216">WooYun: 和讯网修改任意用户密码漏洞</a></p><h2>找回步骤</h2><hr><p>跳过验证步骤、找回方式，直接到设置新密码页面 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-042404">WooYun: OPPO手机同步密码随意修改，短信通讯录随意查看</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2015-098765">WooYun: 中国电信某IDC机房信息安全管理系统设计缺陷致使系统沦陷</a></p><h2>本地验证</h2><hr><p>在本地验证服务器的返回信息，确定是否执行重置密码，但是其返回信息是可控的内容，或者可以得到的内容 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-083035">WooYun: 看我如何重置乐峰网供应商管理系统任意用户密码（管理员已被重置）</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-069987">WooYun: oppo重置任意用户密码漏洞(4)</a></p><h2>发送短信等验证信息的动作在本地进行，可以通过修改返回包进行控制</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-020532">WooYun: OPPO修改任意帐号密码-3</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-020425">WooYun: OPPO修改任意帐号密码-2</a></p><h2>注入</h2><hr><p>在找回密码处存在注入漏洞 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-068060">WooYun: 用友人力资源管理软件（e-HR）另一处SQL注入漏洞（通杀所有版本）</a></p><h2>Token生成</h2><hr><p>token生成可控 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2015-094242">WooYun: 天天网任意账号密码重置(非暴力温柔修改)</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2015-095729">WooYun: 天天网再一次重置任意账号密码(依旧非暴力)</a></p><h2>注册覆盖</h2><hr><p>注册重复的用户名 例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-088708">WooYun: 中铁快运奇葩方式重置任意用户密码(admin用户演示)</a></p><h2>session覆盖</h2><hr><p>例子</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2014-085843">WooYun: 聚美优品任意修改用户密码(非爆破)</a></p><p>附脑图文件：<a href="http://static.wooyun.org/drops/20150309/2015030903011489919%E5%AF%86%E7%A0%81%E6%89%BE%E5%9B%9E%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98.zip">密码找回漏洞挖掘.zip</a></p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/web/3295" rel="bookmark" id="re1">密码找回功能可能存在的问题（补充）</a></li><li><a href="http://drops.wooyun.org/web/5459" rel="bookmark" id="re2">验证码安全问题汇总</a></li><li><a href="http://drops.wooyun.org/papers/346" rel="bookmark" id="re3">终端机的安全性</a></li><li><a href="http://drops.wooyun.org/papers/345" rel="bookmark" id="re4">在线支付逻辑漏洞总结</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">harbour_bin</span> <span class="reply-time">2015-12-06 16:43:55</span></div><p></p><p>又看了一遍....</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">情痴</span> <span class="reply-time">2015-11-17 12:54:20</span></div><p></p><p>学习了，谢谢大牛分享</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Gho</span> <span class="reply-time">2015-08-19 22:58:30</span></div><p></p><p>好多啊。。。。学习啦</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">枯荣</span> <span class="reply-time">2015-08-19 19:31:22</span></div><p></p><p>THX U SHARE</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">hackyandi</span> <span class="reply-time">2015-07-10 16:51:52</span></div><p></p><p>学习了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">harbour_bin</span> <span class="reply-time">2015-06-22 11:52:19</span></div><p></p><p>今天看了第二遍，有了新的体会！赞一下</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Lar2y</span> <span class="reply-time">2015-04-10 18:05:01</span></div><p></p><p>收藏了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小小宝</span> <span class="reply-time">2015-03-27 15:59:13</span></div><p></p><p>天天被打成筛子了，第三个也交了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">围剿</span> <span class="reply-time">2015-03-25 16:39:35</span></div><p></p><p>已经收藏了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">明月影</span> <span class="reply-time">2015-03-14 15:27:30</span></div><p></p><p>认真学习了。总结的很不错</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">kevinchowsec</span> <span class="reply-time">2015-03-13 14:04:34</span></div><p></p><p>nice，全篇看完，案例精彩，给我测试做了很多帮助！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">123</span> <span class="reply-time">2015-03-12 15:33:04</span></div><p></p><p>123</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">肉肉</span> <span class="reply-time">2015-03-10 17:08:41</span></div><p></p><p>其实想问问，楼主你是卖宝马的么</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">light</span> <span class="reply-time">2015-03-10 17:04:08</span></div><p></p><p>收藏起来晚上进被窝慢慢研究~</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">cooFool</span> <span class="reply-time">2015-03-10 13:12:08</span></div><p></p><p>好人</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">笑看天下</span> <span class="reply-time">2015-03-10 11:23:58</span></div><p></p><p>这种思维导图软件楼主用的是那款</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xy小雨</span> <span class="reply-time">2015-03-10 09:29:36</span></div><p></p><p>图片good</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">刘海哥</span> <span class="reply-time">2015-03-10 08:48:42</span></div><p></p><p>+2</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">jianFen</span> <span class="reply-time">2015-03-09 22:39:58</span></div><p></p><p>很喜欢研究逻辑漏洞 谢楼主</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Power</span> <span class="reply-time">2015-03-09 22:23:56</span></div><p></p><p>牛逼，酒还是陈酿的好啊！！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小清新</span> <span class="reply-time">2015-03-09 18:32:38</span></div><p></p><p>脑洞太小~~~~~~~~~~~mark下 慢慢消化</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">大亮</span> <span class="reply-time">2015-03-09 17:14:48</span></div><p></p><p>脑图值能看源地址才能看清楚，再次学习了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">胡小树</span> <span class="reply-time">2015-03-09 16:14:03</span></div><p></p><p>略屌</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">白非白</span> <span class="reply-time">2015-03-09 15:55:44</span></div><p></p><p>+1</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">px1624</span> <span class="reply-time">2015-03-09 15:43:10</span></div><p></p><p>仔细看了一遍，又学了3种新姿势</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">lucky_fn</span> <span class="reply-time">2015-03-09 15:35:43</span></div><p></p><p>收藏了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">C木苦咖啡</span> <span class="reply-time">2015-03-09 15:10:38</span></div><p></p><p>找回密码 - .-</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">loopx9</span> <span class="reply-time">2015-03-09 14:18:59</span></div><p></p><p>使用了不靠谱的短信服务平台也可能造成泄露验证短信等信息，进而可重置密码。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Code_Monkey</span> <span class="reply-time">2015-03-09 14:13:06</span></div><p></p><p>收藏失败 - -.</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">hkAssassin</span> <span class="reply-time">2015-03-09 13:51:07</span></div><p></p><p>看到我的例子出现在了楼主的实例里，<br>我经常会关注此类型漏洞，楼主总结的确实非常全面了。<br>下载留档。<br>点赞</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">todaro</span> <span class="reply-time">2015-03-09 12:55:15</span></div><p></p><p>还有一个，上次看到了，不禁惊讶了一下。第一次发验证码之后，再点解重发的时候抓包。。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">90Snake</span> <span class="reply-time">2015-03-09 12:41:34</span></div><p></p><p>乌云的价值在第一个图里得以展现。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">我是壮丁</span> <span class="reply-time">2015-03-09 11:59:30</span></div><p></p><p>这种总结，才是最有效的沉淀啊</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">only_guest</span> <span class="reply-time">2015-03-09 11:35:58</span></div><p></p><p>看到我的几个例子出现在了楼主的实例里，<br>我经常会关注此类型漏洞，楼主总结的确实非常全面了。<br>下载留档。<br>点赞</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">gainover</span> <span class="reply-time">2015-03-09 11:34:57</span></div><p></p><p>赞作者，赞大乌云。乌云的价值在第一个图里得以展现。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">_Thorns</span> <span class="reply-time">2015-03-09 11:10:56</span></div><p></p><p>先占个沙发再看！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">矢量</span> <span class="reply-time">2015-03-09 11:08:17</span></div><p></p><p>真的能说话？看不太懂唉</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">3xpl0it</span> <span class="reply-time">2015-03-09 10:51:46</span></div><p></p><p>这个好屌。。</p><p></p></div></div></div></div></div></main>