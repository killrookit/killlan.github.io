<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">业务颗粒化思考</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">smarttang</a> <span class="bull">·</span> <time title="2015/02/17 11:18" ui-time="" datetime="2015/02/17 11:18" class="published ng-binding ng-isolate-scope">2015/02/17 11:18</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h1>0x01 需求背景</h1><hr><p>公司发展比较迅速，安全团队增长的速度永远跟不上业务增长的速度，同时给予安全人员的压力越来越大，每个系统的优先级别都一样的前提下，无法想象我们的工作量。同时对于我们来说，工作无法量化思考，领导也无法了解我们到底做了什么。</p><p>我初步列了下这种情况给我们带来什么：</p><pre><code>1. 工作时间无法量化，上峰随时有可能告诉你渗透一个网站只需要1个小时。（WTF）
2. 对业务的不了解，往往解决安全问题时很费脑子，面对复杂的业务逻辑需要一步步分析。（开什么玩笑，大家都这么忙）
3. 老被研发喷，你懂不懂业务！这个就是这么干的！（丢…我要懂还问你么..）
4. 优先级不突出，不明确分级的需求。（妈蛋，大半夜一个被放弃的业务居然要我凌晨起来看看...）
</code></pre><h1>0x02 流程、分级</h1><hr><p>根据目前的情况，我们需要深耕业务，并且把业务进行颗粒化。这个过程枯燥、乏味，但是对于了解业务、提高作业效率有直线的提升。</p><p>具体流程如下：</p><p><img alt="enter image description here" img-src="94cc301759bd8581d30aeba7dece517f10430775.jpg"></p><p>以上是我们需要做的事情，简单阐述，但是并不能把所有的东西都叙述出来，例如，如何分级？如何把优先级别凸显出来？具体级别划分说明如下：</p><pre><code>一级：非常重要、不可以发生意外，跟钱相关，而且用的人非常多。

二级：仅次于一级，跟钱关系不是特别大，但是用的人很多，包括BOSS也会去看的应用。

三级：发生意外也可以忽略，但是最好能够保证没有问题，降低负面影响。
</code></pre><p>在这个过程里面是不是只要划分了等级就可以按照这个管了？或者说，假设在一个小企业，可能安全投入不高的前提下（可以理解为不太重视），我们还能根据业务功能进行分级。将业务里面的每个功能细节都划出来，进行分析。（通常这个都是研发给的interface文档，这个需要自己推动，BTW，看你人缘了。）</p><h1>0x03 实践、结果</h1><hr><p>根据自己所思考并且实践后，通过xmind 画出的图应该如下图一样复杂。</p><p><img alt="enter image description here" img-src="da67d0f3a7fa066571e231ab837fe5aec3be3c72.jpg"></p><p>在这个过程里面，你应该非常深入的了解业务的每个环节，同时知道每个业务有可能存在的风险，并且一一列举出来。当然，你检测每个功能点所耗的时长，应该是一张非常细致的列表。诸如以下这样的方式，给你的上峰。</p><p><img alt="enter image description here" img-src="4056567f31ec1828670b5e9e7c31e0b3672a9ac0.jpg"></p><p>当然，那么小伙伴就会问，这个业务功能颗粒列表具体长什么样子？具体如下：</p><p><img alt="enter image description here" img-src="d0acab98357564f5d902728c26fb9db54485675f.jpg"></p><p>这个是我做了不久的业务，一个内部的业务系统，总共100多个功能模块，并且全部拆解分析，在这个过程当中，我发现了很多以往被我忽略的漏洞（见鬼）。在这个过程里面，分析业务的同时，把漏洞全部深耕出来。诸如以下这样…（诸位抱歉，我不能把公司的安全检测报告全部展现出来..）</p><p><img alt="enter image description here" img-src="d27925ced600a12e864ecf6f0a39c1137f4a85c3.jpg"></p><h1>0x04 最后</h1><hr><p>看完了整个列表和xmind的图后，领导也有些惊讶，原来我们的业务这么复杂，同时工作量居然这么大，从那以后领导再也没有质疑我到底在干嘛，同时表示谅解。在这个过程里面枯燥、乏味，基本上有好多次都准备放弃了。但是得到的好处是，在白帽子爆出一个漏洞时，我可以快速定位到这个漏洞所在的模块，并且迅速的了解到这个模块所存在的问题，然后让研发快速修复这个问题。同时再也不担心研发说我们不懂业务了…</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">milan</span> <span class="reply-time">2015-09-30 16:37:46</span></div><p></p><p>搂住，模板，求 <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="ddeeefe5ebe8e4ede9ed9dacacf3beb2b0">[email&#160;protected]</a></p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">封停</span> <span class="reply-time">2015-05-07 22:46:14</span></div><p></p><p>楼主你写得太好了，<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="4d7c7f79787e7e7e7a79740d3c3c632e2220">[email&#160;protected]</a>，来一发</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-03-04 14:48:03</span></div><p></p><p>我回头再发一篇更加详细的把。。。汗，或者你直接加我QQ跟我说都行。。QQ：505575655</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">missfortune</span> <span class="reply-time">2015-03-02 21:04:55</span></div><p></p><p>楼主能麻烦你发一份报告么<br>我还是安全业务的新手，希望能向楼主多多学习..<br><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="b68386858e84848e8e85f6c7c798d5d9db">[email&#160;protected]</a><br>感激不尽！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Lost_LOF</span> <span class="reply-time">2015-03-02 15:31:21</span></div><p></p><p><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="6c585b5c5d5a545b545c2c1d1d420f0301">[email&#160;protected]</a> 求发一份学习学习，了解下 具体要做什么 怎么做。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-28 15:21:50</span></div><p></p><p>加了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-28 15:20:11</span></div><p></p><p>嗯。。因为领导要求必须要对业务熟悉，所以就做了这个颗粒化的事情。不过没有你想的那么复杂，只要真的把流程走完下来，对业务怎么着都有个深入的了解。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Teufel</span> <span class="reply-time">2015-02-28 14:58:36</span></div><p></p><p><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="546263606c6d6764616c1425257a373b39">[email&#160;protected]</a>，同求O(∩_∩)O哈哈~楼主好人</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Teufel</span> <span class="reply-time">2015-02-28 14:57:02</span></div><p></p><p>做这个必须对业务流程相当了解吧，业务流的走向必须清楚楼主不简单啊</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-28 14:08:29</span></div><p></p><p>额。。客气了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-28 14:08:14</span></div><p></p><p>这个你自己看自己保护的业务就有了啊。。。我发你的估计就是我自己分析我们这边业务的啊！大哥。。你说有啥不理解一起交流学习倒是可以。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-28 14:07:22</span></div><p></p><p>如果不是特别复杂的应用需要2-3天，如果逻辑非常复杂，模块特别多，需要10~15天。因为你需要整理、规划、还有分析、测试，整套流程做完是一件很需要毅力的事情。我做的时候，基本上有数次想放弃的冲动。。。最高峰做到1000多个模块。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">我是壮丁</span> <span class="reply-time">2015-02-27 17:14:23</span></div><p></p><p>真是辛苦楼主了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">左手</span> <span class="reply-time">2015-02-27 15:23:15</span></div><p></p><p>求发一份作为分析，<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="42707a7774757a75707a0233336c212d2f">[email&#160;protected]</a></p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">D＆G</span> <span class="reply-time">2015-02-27 14:56:21</span></div><p></p><p>这样搞下来，一个应用/业务 要搞多久？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-25 23:47:22</span></div><p></p><p>这个我知道的。但是有一点就是如果按照测试给的和你自己挖掘的结果是不一样的，很明显里面包含很多死角，用自己的角度去看业务，甚至了解每个细节会比测试给你的结果更加完整。我看过功能测试的一些文档，我觉得是有点虚的。（我不知道是不是所有都是那样）写这个东西只是启发，做安全的时候可以把所有东西都量化出来，同时可以梳理业务。业务才是核心，我是这么想得。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-25 23:44:03</span></div><p></p><p>这个是提供一个思路。。说白了就是想办法让你的leader了解你在干什么，解决上面所说得一些问题。真实的技术含量不多..</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">为了说话</span> <span class="reply-time">2015-02-25 17:30:46</span></div><p></p><p>LZ了解过功能测试的功能点和业务流程梳理吗，其实都差不多的。。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">codefamily</span> <span class="reply-time">2015-02-25 12:39:43</span></div><p></p><p>没看懂是什么，这个网站公布漏洞前 是不是都修复好的？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-21 21:19:07</span></div><p></p><p>略小。。Sorry。。这文章只是给大家列举下思路...还有工作的感悟。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-21 21:18:16</span></div><p></p><p>主要看你的业务，你可以直接把公司的业务按照这个思路一个个去分析，细化出来就好。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">smarttang</span> <span class="reply-time">2015-02-21 21:16:24</span></div><p></p><p>可以这么理解。。。只是列举下。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">健宇</span> <span class="reply-time">2015-02-18 17:12:08</span></div><p></p><p>很不错的思路，过年了，分享思路图学习一下，<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="cf267574284c692a405e29475e264d6128617eaeaba2a6a18ff6fef8ffe1a0bda8">[email&#160;protected]</a></p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">黄口小儿</span> <span class="reply-time">2015-02-17 18:20:27</span></div><p></p><p>一个盲注。七个跨站？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">malayke</span> <span class="reply-time">2015-02-17 13:16:34</span></div><p></p><p>思维图好小呀</p><p></p></div></div></div></div></div></main>