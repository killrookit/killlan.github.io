<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">iOS URL Scheme 劫持-在未越狱的 iPhone 6上盗取支付宝和微信支付的帐号密码</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">蒸米</a> <span class="bull">·</span> <time title="2015/03/23 14:45" ui-time="" datetime="2015/03/23 14:45" class="published ng-binding ng-isolate-scope">2015/03/23 14:45</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h1>0x00 前言</h1><hr><p>微博:weibo.com/zhengmin1989</p><ul><li><p>该漏洞是 iOS 系统漏洞,和支付宝,微信 app 无关。本文只是拿支付宝和微 信作为演示漏洞的应用,其他应用同样可以中招,转发者请勿断章取义。</p></li><li><p>此漏洞是另一 个漏洞,和“在非越狱的 iPhone 6 (iOS 8.1.3) 上进行钓鱼攻击 (盗取 App Store 密码)”上利 用的漏洞无关,本人不会干用一个漏洞写两个文章灌水的事情。</p></li></ul><p>该漏洞最早是由我在 FireEye 的同事 hui, Song jin 和 lenx 发现的,因为该漏洞利用简单,修 复却非常复杂,所以在 iOS 8.2 上还是未能修复。虽然 iOS 尚未修复,但 app 本身还是可以 有防护的方法,本人在文章最后会提出一些应急的解决方案以供开发人员参考。</p><h1>0x01 DEMO</h1><hr><p>首先来看 demo: 在未越狱的 iPhone6(iOS 8.2)上盗取支付宝帐号密码。 <a href="https://www.youtube.com/watch?v=p86Kv1uHO-s">Youtube</a>(需翻墙): <a href="http://v.qq.com/page/p/d/s/p0149z3tgds.html">腾讯视频</a></p><p><embed src="http://static.video.qq.com/TencentPlayer.swf?vid=p0149z3tgds&auto=0&outhost=http://cf.qq.com/" width="480" height="390"></p><p>在未越狱的 iPhone6(iOS 8.2)上盗取微信支付密码。 <a href="https://www.youtube.com/watch?v=4SfCVGReyKI">Youtube</a>(需翻墙) <a href="http://v.ku6.com/show/yKdd4P9tTaznQUK6fQFPIA...html?from=my">ku6视频</a></p><p><embed src="http://player.ku6.com/refer/yKdd4P9tTaznQUK6fQFPIA../v.swf" width="480" height="390"></p><h1>0x02 DEMO 细节分析(支付宝)</h1><hr><p>在 iOS 上,一个应用可以将其自身”绑定”到一个自定义 URL Scheme 上,该 scheme 用于 从浏览器或其他应用中启动该应用。这个设计非常类似于 android 上的 broadcast 和 broadcast receiver,但远远没有 android 上的复杂。美团利用支付宝付款的整个过程如图一所示:美团 首先将订单信息通过 URL Scheme 发送给 Alipay,Alipay 收到订单信息,调用支付界面,用户 在 Alipay 上完成支付后,Alipay 再发送一个 URL Scheme 给美团,美团收到付款信息后,显 示团购成功的界面。</p><p><img alt="enter image description here" img-src="d2bd4ca1766355620dd25d12c2af9d9a25af8519.jpg"></p><p>图一、正常支付流程</p><p>但因为 URL scheme 这个机制太简单了,完全没有考虑有多个 app 声明同一个 URL Scheme 的情况,也没有权限管理之类的方案。在 iOS 官方说明中:“在多个应用程序注册了同一种 URLScheme 的时候,iOS 系统程序的优先级高于第三方开发程序。但是如果一种URLScheme 的注册应用程序都是第三方开发的,那么这些程序的优先级关系是不确定的。”实际上,经 过我们的测试,这个顺序是和 Bundle ID 有关的,如果精心构造 Bundle ID,iOS 总是会调用 我们 app 的 URL Scheme 去接收相应的 URL Scheme 请求。那么问题来了,如果我们精心构 造一个 app 并声明“alipay”这个 URL Scheme 会怎么样呢?</p><p>结果就如 demo 中所演示的那样,后安装的 FakeAlipay 应用劫持了美团与支付宝之间的支付 流程,并且可以在用户毫无意识情况下获取用户的帐号,支付密码,以及帮用户完成支付。 整个过程如图二所示:FakeAlipay 在收到美团发来的订单信息后,构造了一个和支付宝一样 的登陆界面,用户在输入了帐号密码后,FakeAlipay 会把帐号密码以及订单信息发送到黑客 的服务器上,黑客在获得了这些信息后,可以在自己的 iOS 设备上完成支付,并把支付成功 的 URL Scheme 信息发回给 FakeAlipay,FakeAlipay 再把支付成功的 URL Scheme 信息转发给 美团。因为时间原因,demo 做得比较粗糙,没有做转发信息给美团这一部分的演示,但绝 对是可行的。</p><p><img alt="enter image description here" img-src="3120ae5754225d8f2f444043ebcbd0937928bebf.jpg"></p><p>图二、劫持后的支付流程</p><p>这种攻击可以成功的原因除了 iOS 本身的漏洞外,支付宝也有一定的责任。那就是发给支付 宝的订单信息并不是绑定当前设备的。因为这个原因,黑客可以在其他的 iOS 设备上完成支 付。 同样是因为不绑定当前设备的问题,黑客甚至可以先在自己的设备上生成好订单,然 后在用户打开支付宝支付的时候把订单替换掉,让用户给黑客的订单买单。</p><h1>0x03 DEMO 细节分析(微信)</h1><hr><p>基本上和支付宝一样,不过支付时只需要提供 6 位支付密码,如 果想要得到微信帐号密码的话,还需要构造一个假的登陆界面。当然了,你可能会说有短信 验证,但是如果整个登录界面都是伪造的话,用户也会乖乖的帮你输入短信验证码的。并且, 在 iOS 8.1 之前,iOS 的短信也存在监控漏洞,具体请参考我们 ASIACCS 的论文。</p><p>好吧,讲到这里肯定又有人说:你的漏洞是挺严重的,但还是得往我机器上装 app 啊。我从 来不用什么 pp 助手,同步推之类的,也不装什么企业应用,平时只在 AppStore 上下载,因 为有苹果的审核,所以我肯定不会中招的。呵呵,苹果的审核真的信得过么?请看第二个 demo: Google Chrome URL Scheme 劫持</p><p><a href="https://www.youtube.com/watch?v=uqZPelheVdM">Youtube</a>(需翻墙) <a href="http://v.qq.com/page/x/d/4/x0149k4red4.html">腾讯视频</a></p><p><embed src="http://static.video.qq.com/TencentPlayer.swf?vid=x0149k4red4&auto=0&outhost=http://cf.qq.com/" width="480" height="390"></p><p><img alt="enter image description here" img-src="9ff0e5beda26633994002fce528ad87c64090eb1.jpg"></p><p>图三、Google Chrome URL Scheme 劫持</p><p>Google 公司不比阿里差吧?Google Chrome 可以算是 Google 在 iOS 上最重要的应用之一了吧? 可惜的是,在该 demo 中 Google 公司的 Chrome 应用已经非常不幸的被 App Store 下载的 app 劫持掉了。如图三所示:演示用的 app 会利用 Google Chrome 的 URL Scheme 去打开 Google.com 这个网站。在机器上只安装 Chrome 的情况下,app 会跳转到 Chrome 打开 Google.com。但是当我们在 App Store 下载完一个叫 BASCOM Browser 的 app 之后,app 却会 跳转到 BASCOM Browser 打开 Google.com。经过统计,App Store 上有大量的应用声明了 Chrome 以及 FaceBook 的 URL scheme,并且他们的开发者并不属于 Google 和 Facebook。这 说明 Apple 根本就没有保护那些热门应用的 URL Scheme 的想法,上传的 App 无论声明什么样的 URL Scheme,苹果都会通过审核的。所以说,不光 Chrome,Facebook 有危险,支付宝, 微信啥的也逃不过这一劫。</p><h1>0x04 解决方案</h1><hr><h2>1. 针对 iOS 系统。</h2><hr><p>因为 Bundle ID 在 App Store 上是唯一的(类似 Android 上的 package name)苹果可以限制 iOS 应用不能注册别的应用的 Bundle ID 作为 URL Scheme。这 样的话,使用自己的 Bundle ID 作为 URL Scheme 的接收器就会变的安全很多。</p><h2>2. 针对第三方应用</h2><hr><p>既然苹果不发布补丁保护第三方应用。第三方应用就没有办法了么? 不是的,这里至少有两种方法可以检测自己应用的 URL Scheme 是否被 Hijack:</p><p>(1)、应用本 身可以发送一条 URL Scheme 请求给自己,如果自己可以接收到的话,说明 URL Scheme 没 有被劫持,如果不能收到的话,就说明被劫持了,这时候可以提醒用户卸载有冲突的 app。</p><p>代码如下:</p><pre><code>[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@“alipay://test“]];
</code></pre><p>(2)、利用 MobileCoreServices 服务中的 applicationsAvailableForHandlingURLScheme()方法可以 所有注册了该 URL Schemes 的应用和处理顺序,随后应用就可以检测自己,或者别人的 URL Scheme 是否被劫持了。代码如下:</p><pre><code>Class LSApplicationWorkspace_class = objc_getClass("LSApplicationWorkspace");
NSObject* workspace =
[LSApplicationWorkspace_class performSelector:@selector(defaultWorkspace)]; NSLog(@"openURL: %@",[workspace performSelector:@selector(applicationsAvailableForHandli ngURLScheme:)withObject:@"alipay"]);
</code></pre><p>在任意 app 下运行这个函数,可以返回 URL 处理的顺序,比如运行结果是:</p><pre><code>2015-03-18 15:34:37.695 GetAllApp[13719:1796928] openURL: (
"&lt;LSApplicationProxy: 0x156610010&gt; com.mzheng.GetAllApp", "&lt;LSApplicationProxy: 0x1566101f0&gt; com.mzheng.Alipay", "&lt;LSApplicationProxy: 0x15660fc30&gt; com.alipay.iphoneclient"
)
</code></pre><p>说明有三个 app 都声名了 alipay 这个 URL shceme,并且会处理这个请求的是 "com.mzheng.GetAllApp",而不是支付宝。</p><h1>0x05 文章更新</h1><hr><p>刚说完支付宝,微信逃不过这一劫,我们已经在 App Store 上发现了 劫持了支付宝的真实案例。</p><p>来看 demo: 战旗 TV 劫持支付宝 URL Scheme Youku:</p><p><embed src="http://player.youku.com/player.php/sid/XOTE3NTc0MjM2/v.swf" allowfullscreen="true" quality="high" width="480" height="400" align="middle" allowscriptaccess="always" type="application/x-shockwave-flash"></p><p>当用户想要使用支付宝支付的时候,却跳转到了战旗 TV。这里想问一下战旗 TV,你到底想 要干些什么呢?:-)</p><p>PS:各大公司是不是要开始推送 iOS 手机安全助手了?</p><p>2015/03/23文章更新:战旗tv已经得到反馈，正在紧急修复bug。</p><h1>0x06 参考文献:</h1><hr><p>1.iOS Masque Attack: <a href="https://www.fireeye.com/blog/threat-research/2015/02/ios_masque_attackre.html">LINK</a></p><p>￼ 2.Min Zheng, Hui Xue, Yulong Zhang, Tao Wei, John C.S. Lui "Enpublic Apps: Security Threats Using iOS Enterprise and Developer Certificates", ACM Symposium on Information, Computer and Communications Security (ASIACCS'15), Singapore, April 2015</p><p>3.在非越狱的 iPhone 6 (iOS 8.1.3) 上进行钓鱼攻击 (盗取 App Store 密码): <a href="http://blog.csdn.net/zhengminwudi/article/details/43916791">LINK</a></p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div id="donate" style="padding:10px;border-top:1px solid #d9d9d9;text-align:center"><span>碎银子打赏，作者好攒钱娶媳妇：</span><br><br><img src="http://static.wooyun.org/wooyun/upload/donate/201507292354527496d304665a3c721617737c107e4e87.png" style="width:200px;height:200px"></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/papers/2893" rel="bookmark" id="re1">Intent scheme URL attack</a></li><li><a href="http://drops.wooyun.org/mobile/7431" rel="bookmark" id="re2">三种新的针对IOS的假面攻击方法（Masque Attacks）</a></li><li><a href="http://drops.wooyun.org/papers/5232" rel="bookmark" id="re3">Android DropBox SDK漏洞（CVE-2014-8889）分析</a></li><li><a href="http://drops.wooyun.org/papers/10642" rel="bookmark" id="re4">三星安卓5.0设备WifiCredService 远程代码执行</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">微笑吧</span> <span class="reply-time">2015-04-05 23:18:48</span></div><p></p><p>支付宝会根据支付设备情况推送检验，这个是没有问题的啊</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">郑德才博客</span> <span class="reply-time">2015-03-27 13:26:25</span></div><p></p><p>什么都不安全！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">sxyzbbs</span> <span class="reply-time">2015-03-27 10:39:21</span></div><p></p><p>可以被利用的现有规则或策略不是漏洞?</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Y.Boy</span> <span class="reply-time">2015-03-26 19:53:31</span></div><p></p><p>看这样是否有效：<br>支付宝和美团之间可以约定一个私钥，如果私钥检查不通过，说明有问题了。<br>例如：美团向支付宝发送请求时，带上一个经过加密的key，在支付宝完成支付后，会向美团返回另一个加密过的key2，如果在美团端解密不成功，说明这个key2不是来自正版支付宝的。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">richard</span> <span class="reply-time">2015-03-26 17:07:19</span></div><p></p><p>我一直在想 如果用户 双击home 开启多任务模式 不就能看见这个app的 icon 了吗（icon相同AppStore审核肯定过不了~） 这样不就发现这个挂羊头卖狗肉的app了吗</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小熊饼干</span> <span class="reply-time">2015-03-26 16:16:23</span></div><p></p><p>安卓也是如此的，有个问题就是用户怎么知道哪个是真的？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">kk</span> <span class="reply-time">2015-03-25 17:45:28</span></div><p></p><p>只有后4位，是通过iOS scheme信息传过去的。有什么不科学</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">火星猫</span> <span class="reply-time">2015-03-25 16:36:44</span></div><p></p><p>假微信里面居然知道用户的招商银行卡和卡号后4位，不科学啊～</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">阿萨德飞</span> <span class="reply-time">2015-03-25 11:27:05</span></div><p></p><p>钓鱼网站随处可见，难道说是浏览器的漏洞嘛</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">tonado</span> <span class="reply-time">2015-03-24 23:38:23</span></div><p></p><p>人家苹果官方文档说的很清楚，不保证哪个应用被调用，这算个毛漏洞</p><p>https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhon<br>eOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html</p><p>Note: If more than one third-party app registers to handle the same URL<br>scheme, there is currently no process for determining which app will be<br>given that scheme.</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0xffee</span> <span class="reply-time">2015-03-24 21:05:44</span></div><p></p><p>厉害，Mark.. ps:你女票好漂亮!</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">喵一个</span> <span class="reply-time">2015-03-24 16:39:21</span></div><p></p><p>以前貌似遇到过有的应用URL Scheme冲突的情况，不过及时修正了，感觉不是多大的问题，另外伪造支付平台界面这种的，审核也没法过吧...这标题略显夸张=。=</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Pao</span> <span class="reply-time">2015-03-24 15:36:22</span></div><p></p><p>人家是香港中文大学的博士生，分分钟教高中英语老师做人</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">时尚时尚</span> <span class="reply-time">2015-03-24 14:45:01</span></div><p></p><p>真是瞎jb扯淡</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Jesse</span> <span class="reply-time">2015-03-24 14:20:47</span></div><p></p><p>用了not only... but语句，不仅...而且，看来高中英语老师教得好。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">phith0n</span> <span class="reply-time">2015-03-24 13:41:48</span></div><p></p><p>确实呀。。。app store审核最近又变严格了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">sr5220</span> <span class="reply-time">2015-03-24 13:13:03</span></div><p></p><p>惊讶</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">’‘Nome</span> <span class="reply-time">2015-03-24 12:07:16</span></div><p></p><p>想问下，，， 作者你是国人还是国外人？？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">匿名用户</span> <span class="reply-time">2015-03-24 11:32:42</span></div><p></p><p>呵呵，使用LSApplicationWorkspace以后，应用能通过审核吗？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">匿名用户</span> <span class="reply-time">2015-03-24 11:04:03</span></div><p></p><p>钓鱼app是完全可以通过苹果的审核。<br>换句话说，苹果目前没有针对这一点做审核。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">匿名用户</span> <span class="reply-time">2015-03-24 11:02:06</span></div><p></p><p>不需要bundle id<br>只需要app注册scheme url，按照苹果的跪着，后注册的scheme url是优先级最高的。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Lemon</span> <span class="reply-time">2015-03-24 10:10:09</span></div><p></p><p>看起来很牛逼的样子，你是要自己盗自己的钱吗？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">cj1024</span> <span class="reply-time">2015-03-24 10:03:40</span></div><p></p><p>同样是 url scheme 跳转，微软在处理上就稍微聪明了点，冲突的 scheme 每次打开时都会让用户从这些应用中选一个…</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">allanchan</span> <span class="reply-time">2015-03-24 09:03:10</span></div><p></p><p>这个漏洞我之前在做电商的时候已经发现了，只不过想不到真的是可以挟持的到。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">呼呼呼山</span> <span class="reply-time">2015-03-24 08:57:47</span></div><p></p><p>不一定非要用在支付宝应用上啊，感觉可以进行应用推广什么的。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">kk</span> <span class="reply-time">2015-03-24 05:46:21</span></div><p></p><p>iOS Scheme 那个问题，是个开发者仔细读过文档就知道，文档都提到不确定会打开哪个App，所以根本不是什么新发现，这是个公开的信息。不知道的刚知道就觉得特神奇还要发表论文也是陶醉…关键是到最后你也不可能支付成功，而且一下子揭穿了。iOS Scheme这类就是单纯的跳转，用在支付应用上本来就不是特别合适。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">kk</span> <span class="reply-time">2015-03-24 04:37:38</span></div><p></p><p>https://threatpost.com/malicious-urls-pose-mobile-hijacking-risk-110910/74653</p><p>这个问题2010年就有人注意到了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">c9527</span> <span class="reply-time">2015-03-24 01:16:10</span></div><p></p><p>楼主，支付宝这段不可行，支付宝客户端是会验证可信设备环境的，你之所以能成功是因为你的操作过程都在你的支付宝账号的可信设备上，如果你换一台从未登陆过该支付宝客户端的设备，支付宝会认为你在一个非授信环境会要求短信验证的；而且支付宝客户端有手机锁的设定，虽然默认未开启但是也可防范你所说的攻击，另外支付宝还有一个登陆消息提醒功能</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">着魔</span> <span class="reply-time">2015-03-24 00:56:23</span></div><p></p><p>马克一下，早上细看</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">horseluke</span> <span class="reply-time">2015-03-23 21:15:04</span></div><p></p><p>你没看清楚，案例中有App store的应用（BASCOM Browser，战旗TV），也就是说App store审核完全可以绕过。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">元方</span> <span class="reply-time">2015-03-23 19:59:58</span></div><p></p><p>居然看懂了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">shippo7</span> <span class="reply-time">2015-03-23 19:59:55</span></div><p></p><p>另外前两个演示视频的伪应用看上去并不在app store上，虽然手机没有越狱，伪应用应该是演示者自己编写然后用开发者证书安装在自己手机上的。在应用中使用第三方商标无法通过app store审核。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">shippo7</span> <span class="reply-time">2015-03-23 19:46:11</span></div><p></p><p>文章里已经说了，这一切都必须先给用户安装伪应用，实际上实现起来并不容易。用户要先看到伪应用的app store页面，自己点击“获取”按钮，自己输入Apple ID密码，然后屏幕上多一个伪应用图标，之后才能被攻击。即使用企业证书，攻击者也面临着滥用企业证书被吊销证书的风险。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">insight-labs</span> <span class="reply-time">2015-03-23 19:37:06</span></div><p></p><p>赞！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xiaoyao9933</span> <span class="reply-time">2015-03-23 19:18:19</span></div><p></p><p>360心想，安全软件终于有用武之地了。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xiaoyao9933</span> <span class="reply-time">2015-03-23 19:14:33</span></div><p></p><p>ccav看这里看这里</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">麦香浓郁</span> <span class="reply-time">2015-03-23 19:02:36</span></div><p></p><p>前提是你要有一个肾</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Comer</span> <span class="reply-time">2015-03-23 18:29:24</span></div><p></p><p>留名回去搬板凳看~对了，8.1.2 也有？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">c2y2</span> <span class="reply-time">2015-03-23 18:14:04</span></div><p></p><p>虽说没有iphone 但是还是由衷的 赞一个！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">打酱油的小男孩</span> <span class="reply-time">2015-03-23 17:39:13</span></div><p></p><p>首先得有个iphone6</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">袋鼠妈妈</span> <span class="reply-time">2015-03-23 17:18:55</span></div><p></p><p>好屌</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Hack1314</span> <span class="reply-time">2015-03-23 16:47:57</span></div><p></p><p>看着很不错哎！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">springemp</span> <span class="reply-time">2015-03-23 16:38:26</span></div><p></p><p>第三方的修复方式一很容易就存在绕过吧</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Finder</span> <span class="reply-time">2015-03-23 16:32:17</span></div><p></p><p>安卓上面也有类似的问题，你甚至能控制支付宝打开一个你的钓鱼页面。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">红客十年</span> <span class="reply-time">2015-03-23 16:27:33</span></div><p></p><p>学习了。楼上惊现黑阔………</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Helen</span> <span class="reply-time">2015-03-23 16:26:16</span></div><p></p><p>楼主是我爹，特地来围观</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">招财猫</span> <span class="reply-time">2015-03-23 16:26:04</span></div><p></p><p>吊炸天</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">ModNar</span> <span class="reply-time">2015-03-23 16:18:11</span></div><p></p><p>赞~思路有点像jsonhijack+CSRF<br>两个问题：<br>1. 精心构造的Bundle ID，有啥规则能提高优先级？<br>1.“让用户给黑客的订单买单”如何绕过签名，用别人的密码给自己的订单支付？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">浅蓝</span> <span class="reply-time">2015-03-23 16:12:05</span></div><p></p><p>好屌</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Gmxp</span> <span class="reply-time">2015-03-23 16:11:23</span></div><p></p><p>是说3那个运营商吗？楼主应该是在香港，3是香港的一个电信运营商。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">JustBear_ILY</span> <span class="reply-time">2015-03-23 16:07:15</span></div><p></p><p>前排前排ccav看这里！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">JustBear_ILY</span> <span class="reply-time">2015-03-23 16:06:28</span></div><p></p><p>哇擦擦搞坏事啊，好好玩！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">some one</span> <span class="reply-time">2015-03-23 15:58:01</span></div><p></p><p>请教一下博主 iOS 8 未越狱修改运营商名称的方法 谢谢博主</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">mtfly</span> <span class="reply-time">2015-03-23 15:55:40</span></div><p></p><p>这个时候 <a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="9076083f74281d76083f783611d0742810742a0b742a2a742a16">[email&#160;protected]</a></p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">m1x7e1</span> <span class="reply-time">2015-03-23 15:23:31</span></div><p></p><p>屌！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">浩天</span> <span class="reply-time">2015-03-23 15:18:09</span></div><p></p><p>薅</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">爱上平顶山</span> <span class="reply-time">2015-03-23 15:16:54</span></div><p></p><p>厉害~</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">zeracker</span> <span class="reply-time">2015-03-23 15:14:52</span></div><p></p><p>这么屌。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">liyang</span> <span class="reply-time">2015-03-23 15:04:23</span></div><p></p><p>文章很赞~ps 标题开头应该是iOS吧~</p><p></p></div></div></div></div></div></main>