<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">密码找回功能可能存在的问题</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">瞌睡龙</a> <span class="bull">·</span> <time title="2013/07/17 23:51" ui-time="" datetime="2013/07/17 23:51" class="published ng-binding ng-isolate-scope">2013/07/17 23:51</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h3>0x00 背景介绍</h3><hr><p>有人的地方就有江湖。</p><p>互联网中，有用户注册的地方，基本就会有密码找回的功能。</p><p>而密码找回功能里可能存在的漏洞，很多程序员都没有想到。</p><p>而这些漏洞往往可能产生非常大的危害，如用户账号被盗等。</p><p>并且这种漏洞在非常多的大互联网公司中都出现过。</p><h3>0x01 检测方式及案例</h3><hr><p>乌云上搜索：<code>密码找回，密码修改，密码重置</code>关键字。</p><p>总结出以下7点，如有其它的还望提醒补充~！</p><p>大家在为公司项目做测试的时候可做参考。</p><p>找回密码存在缺陷的地方有几处：</p><h4>1、密码找回的凭证太弱，如只需要填入一个四位或者六位的纯数字就可以重置密码，导致可以暴力破解。</h4><p>案例：</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-011833">WooYun: 当当网任意用户密码修改漏洞</a></p><p>还有一个做了限制但是被绕过的经典案例：</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-011720">WooYun: 微信任意用户密码修改漏洞</a></p><p>限制了提交次数，但是存在逻辑问题，可以绕过，具体可以点击去看下。</p><h4>2、密码找回凭证可从客户端直接获取。</h4><p>密码找回凭证在客户端获取，在密码找回时注意抓包查看所有url返回响应等，看是否有最终的凭证出现，这样就可以绕过手机或者安全邮箱了。</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-05630">WooYun: 走秀网秀团任意密码修改缺陷</a></p><h4>3、密码找回凭证在页面中可以直接获取。</h4><p>一个经典案例，找回密码的答案在网页的源代码中……</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-04728">WooYun: sohu邮箱任意用户密码重置</a></p><h4>4、密码找回凭证可以比较容易的猜出。</h4><p>找回密码的关键凭证仅仅是时间戳的md5，被白帽子犀利的察觉到~，轻松找回任意账户密码。</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-08333">WooYun: 奇虎360任意用户密码修改漏洞</a></p><h4>5、密码找回凭证存并非只是与单个用户并绑定的问题。</h4><p>找回密码凭证发到邮箱中，url中包含用户信息以及凭证，但是这个凭证可以重置任何用户。</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-012572">WooYun: 身份通任意密码修改-泄漏大量公民信息</a></p><h4>6、用户找回密码的邮箱地址或者手机号码被修改。</h4><p>这个其实应该是绑定安全手机的逻辑问题，导致可以使任意用户帮上自己可控的安全手机，然后就可以重置任意人的手机号码了。</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2012-08307">WooYun: 网易邮箱可直接修改其他用户密码</a></p><h4>7、在最后提交修改的密码处的逻辑错误。</h4><p>前面所有的逻辑都没有问题，那么是不是就没有问题了呢？</p><p>还有白帽子发现，在最后重置密码处跟随一个用户ID，改成其它用户的ID，即可把其它用户改成你刚刚修改的密码。</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-018263">WooYun: 携程旅行网任意老板密码修改(庆在wooyun第100洞)</a></p><h3>0x02 修复方案</h3><hr><p>找回密码凭证够复杂并且不可猜测，同时注意以上逻辑问题，不可存在越权，或者重要的凭证在不该出现的地方出现。</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div id="donate" style="padding:10px;border-top:1px solid #d9d9d9;text-align:center"><span>碎银子打赏，作者好攒钱娶媳妇：</span><br><br><img src="http://static.wooyun.org/wooyun/upload/donate/20141017203549ef27b55a7921e022214b5780c48f81e0.png" style="width:200px;height:200px"></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/web/3295" rel="bookmark" id="re1">密码找回功能可能存在的问题（补充）</a></li><li><a href="http://drops.wooyun.org/web/5048" rel="bookmark" id="re2">密码找回逻辑漏洞总结</a></li><li><a href="http://drops.wooyun.org/papers/345" rel="bookmark" id="re3">在线支付逻辑漏洞总结</a></li><li><a href="http://drops.wooyun.org/papers/346" rel="bookmark" id="re4">终端机的安全性</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">yt.</span> <span class="reply-time">2016-06-08 12:56:37</span></div><p></p><p>有收获</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">曾.经.拥.有</span> <span class="reply-time">2016-04-08 14:13:21</span></div><p></p><p>很好</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">我的舞台我做主</span> <span class="reply-time">2015-12-20 20:49:38</span></div><p></p><p>很好</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">有你陪伴永不散</span> <span class="reply-time">2015-12-13 06:35:09</span></div><p></p><p>@园长</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">ll</span> <span class="reply-time">2015-12-04 18:01:19</span></div><p></p><p>lll</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">情痴</span> <span class="reply-time">2015-11-16 23:23:00</span></div><p></p><p>学习了，大牛辛苦了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">1352739061qq.com</span> <span class="reply-time">2015-10-13 23:58:46</span></div><p></p><p>呵呵来学习了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">1352739061qq.com</span> <span class="reply-time">2015-10-13 23:56:43</span></div><p></p><p>曲朋</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Mark0smith</span> <span class="reply-time">2015-08-29 00:06:38</span></div><p></p><p>作者写的很好啊，感觉这一定会是个有趣的问题</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">瞌睡龙</span> <span class="reply-time">2013-07-20 12:55:26</span></div><p></p><p>其实5、6、7都一样，都是越权。其实1、2、3、4都一样是凭证太弱被猜出或找到。其实1、2、3、4、5、6、7都一样都是密码找回功能有问题~</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">byr5ec</span> <span class="reply-time">2013-07-19 21:19:15</span></div><p></p><p>第6个和第7个基本一样，没有对权限控制好，只要知道uid就可以对其进行越权操作。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">test</span> <span class="reply-time">2013-07-19 10:22:28</span></div><p></p><p>总结得不错</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">熊猫</span> <span class="reply-time">2013-07-18 20:12:58</span></div><p></p><p>最爱!</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">pfdz</span> <span class="reply-time">2013-07-18 15:16:41</span></div><p></p><p>这个总结的很好。。其实验证码绕过也可以发一篇类似的文章了。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">sdj</span> <span class="reply-time">2013-07-18 15:13:06</span></div><p></p><p>学习了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小仙仙</span> <span class="reply-time">2013-07-18 14:07:36</span></div><p></p><p>嗯受教了，密码找回问题，很全面。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">园长</span> <span class="reply-time">2013-07-18 12:25:23</span></div><p></p><p>再补下SQLJ。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">命运</span> <span class="reply-time">2013-07-18 11:47:22</span></div><p></p><p>= =说的真委婉</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">瞌睡龙</span> <span class="reply-time">2013-07-18 10:24:15</span></div><p></p><p>少年 java[4] 该发来了哈哈哈~<br>让其他人浮躁的刷rank去吧……</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">园长</span> <span class="reply-time">2013-07-18 10:08:43</span></div><p></p><p>哈哈，支持。</p><p></p></div></div></div></div></div></main>