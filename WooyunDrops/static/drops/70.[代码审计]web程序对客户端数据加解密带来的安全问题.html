<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">[代码审计]web程序对客户端数据加解密带来的安全问题</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">Yaseng</a> <span class="bull">·</span> <time title="2013/08/19 11:26" ui-time="" datetime="2013/08/19 11:26" class="published ng-binding ng-isolate-scope">2013/08/19 11:26</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h2>0x00 前言</h2><hr><p>对于一个完善系统而言,无论是桌面还是web程序, 都会使用客户端保存数据如cookie,db文件等。为了不让外部获取或者控制,系统会对数据进行私有加密 例如qq密码,聊天记录,web程序中用户信息等。而对于开源程序而言,算法是公开的,对数据的加密只有依靠key来保护数据 ,一旦数据可控就可能造成某些安全问题,本文探讨web开源程序中对私有数据的使代码的安全性问题。</p><h2>0x01 直捣黄龙:key可知</h2><hr><p>某些加密key可推算抑或可爆破情况下,私有数据数据完全可控,根据实际环境sql注入,xss,越权等攻击。</p><p>例如:</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-020759">WooYun: Espcms v5.6 暴力注入</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-018567">WooYun: dedecms sql injection</a></p><p><a href="http://www.80vul.com/archives/107.html">PHPCMS V9 sys_auth()设计缺陷导致多个SQL注入漏洞</a></p><h2>0x02  隔山打牛:key不可知</h2><hr><p>为了数据和代码的统一,一套系统中数据的加密解密key一般是通用的,我们可以利用程序的某些功能来生成加密之后的数据,从而控制程序的私有数据,进行攻击。</p><p>类似的案例如:</p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-024984">WooYun: PHPCMS最新版(V9)SQL注入一枚</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-031669">WooYun: espcms 二次注入一枚</a></p><p><a target="_blank" href="http://www.wooyun.org/bugs/wooyun-2013-034014">WooYun: Espcms加密函数缺陷导致getshell</a></p><h2>0x03 总结</h2><hr><p>当变量能控时,一切数据都是危险的,程序除了对输入输出的数据做严格过滤之外,对内部私有数据也要相应的过滤。</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/papers/2035" rel="bookmark" id="re1">一些常见的重置密码漏洞分析整理</a></li><li><a href="http://drops.wooyun.org/papers/346" rel="bookmark" id="re2">终端机的安全性</a></li><li><a href="http://drops.wooyun.org/papers/345" rel="bookmark" id="re3">在线支付逻辑漏洞总结</a></li><li><a href="http://drops.wooyun.org/web/3295" rel="bookmark" id="re4">密码找回功能可能存在的问题（补充）</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">possible</span> <span class="reply-time">2013-08-28 09:49:24</span></div><p></p><p>都不用滚动条 真好</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">erevus</span> <span class="reply-time">2013-08-20 15:00:53</span></div><p></p><p>成正比的...嘿嘿嘿</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">xsser</span> <span class="reply-time">2013-08-19 19:50:15</span></div><p></p><p>好短</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">瞌睡龙</span> <span class="reply-time">2013-08-19 11:29:39</span></div><p></p><p>总结的不错~！就是略显简短了点 :)</p><p></p></div></div></div></div></div></main>