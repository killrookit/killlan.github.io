<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">一条Python命令引发的漏洞思考</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">安全小飞侠</a> <span class="bull">·</span> <time title="2015/12/15 10:09" ui-time="" datetime="2015/12/15 10:09" class="published ng-binding ng-isolate-scope">2015/12/15 10:09</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><div class="error">本文章因版权问题，不对外开放，<a href="http://drops.wooyun.org/login">登陆</a>后可查看。</div><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/tips/2420" rel="bookmark" id="re1">下载文件的15种方法</a></li><li><a href="http://drops.wooyun.org/tips/349" rel="bookmark" id="re2">解密JBoss和Weblogic数据源连接字符串和控制台密码</a></li><li><a href="http://drops.wooyun.org/papers/11690" rel="bookmark" id="re3">WebLogic之Java反序列化漏洞利用实现二进制文件上传和命令执行</a></li><li><a href="http://drops.wooyun.org/tips/14020" rel="bookmark" id="re4">TFTP反射放大攻击浅析</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">bird</span> <span class="reply-time">2015-12-17 21:06:18</span></div><p></p><p>到了服务器上了直接屏蔽exec执行的任何处理</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">大和尚</span> <span class="reply-time">2015-12-16 18:16:10</span></div><p></p><p>逆向思维好棒!</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">botak</span> <span class="reply-time">2015-12-16 11:21:29</span></div><p></p><p>把作者的代码格式整了下.对应看了bugscan的bin/core_new 发现还是TM看不懂..</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">安全小飞侠</span> <span class="reply-time">2015-12-15 17:16:43</span></div><p></p><p>@Manning 因为exec方法既可以执行Python语句也可以执行编译后的code object对象，于是想到这个思路尝试从本地执行的编译后的code object对象还原远程服务器上的编译前的Python源码。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Manning</span> <span class="reply-time">2015-12-15 14:59:42</span></div><p></p><p>pyc文件可访问，然后反编译了pyc，获得了源码。这跟exec执行代码有什么关系</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">abc123</span> <span class="reply-time">2015-12-15 11:42:10</span></div><p></p><p>@ha4k Python的代码混淆一般也就是替换函数名和参数名为无意义的字符串，其实还是很好分析的吧</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">ha4k</span> <span class="reply-time">2015-12-15 11:16:00</span></div><p></p><p>@Her0in 做了混淆，眼睛都看花，没什么好参考的。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Leeboble</span> <span class="reply-time">2015-12-15 10:45:01</span></div><p></p><p>这几天怎么扎了堆儿的对python进行代码分析，来篇Ruby on Rails的呗。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Her0in</span> <span class="reply-time">2015-12-15 10:18:05</span></div><p></p><p>很明显，你是在使用了 BugScan 后做的分析！</p><p></p></div></div></div></div></div></main>