<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">Shodan搜索引擎介绍</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">修码的马修</a> <span class="bull">·</span> <time title="2014/06/30 15:35" ui-time="" datetime="2014/06/30 15:35" class="published ng-binding ng-isolate-scope">2014/06/30 15:35</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><p>from:http://www.exploit-db.com/wp-content/themes/exploit/docs/33859.pdf</p><hr><h2>0x00 概要</h2><hr><p>这篇文章可以作为渗透测试人员和安全工作者运用Shodan搜索引擎的指南，同时有助于理解其工作原理和达到安全审计目的。文章也列举出找到大量有风险的互联网服务及其设备的步骤和方法。同时介绍了Shodan能用初级筛选语法以及Shodan和其他工具的联合运用。主要适用于渗透测试的数据收集阶段。</p><h2>0x01 介绍</h2><hr><p>Shoudan是一个用于帮助发现主要的互联网系统漏洞（包括路由器，交换机，工控系统等）的搜索引擎。它在圈子里就像google一样出名。它主要拦截从服务器到客户端的元数据来工作，目前提供超过50个端口的相关搜索。</p><p>Shodan能找到的设备：</p><pre><code>1.服务器
2.路由器
3.交换机
4.公共ip的打印机
5.网络摄像头
6.加油站的泵
7.Voip电话和所有数据采集监控系统
</code></pre><p>Shodan能做的：</p><pre><code>1.用户搜索制定的项目
2.Shodan寻找端口并拦截数据
3.Shodan为拦截的数据设置索引
4.显示结果
</code></pre><p>Shodan和google的区别：</p><pre><code>Google的爬虫/蜘蛛 抓取网页数据并为网页内容创建索引，然后更具page rank显示结果。Shoudan主要寻找端口并抓取拦截到的信息，然后为它们建立索引，最后显示结果。Shoudan并不像google那样为网页内容建立索引，因此它是一个基于拦截器的搜索引擎。
</code></pre><h2>0x02 基础用法</h2><hr><p>City：用于寻找位于指定城市的设备。例：</p><pre><code>iis city:New York 
</code></pre><p>County：用于寻找位于指定国家的设备。例：</p><pre><code>iis country: United States  
</code></pre><p>Port：限定指定的端口。例：</p><pre><code>https port:443 
</code></pre><p>Os：用于寻找特定的操作系统。例：</p><pre><code>microsoft-iis os:"windows 2003"
</code></pre><p>Geo：根据经纬度和指定的半径来返回结果。只能有2个或3个参数，第三个参数是半径，默认数值之5km。例：</p><pre><code> apache geo:42.9693,-74.1224
</code></pre><p>Net：用于寻找指定ip地址和子网掩码的设备。例：</p><pre><code> iis net:216.0.0.0/16 
</code></pre><p>Hostname：用于搜索包含指定域名的主机。例：</p><pre><code>Akamai  hostname:.com
</code></pre><p>After and Before: 帮助找到指定日期范围的设备。格式：dd/mm/yyyy dd-mm-yy 例：</p><pre><code>apache before:1/01/2014       
nginx after:1/01/2014  
</code></pre><p>注意：登陆后大多数参数都能运作。</p><h2>0x03 Shodan和其他工具的结合</h2><hr><h3>1.和Maltego的结合</h3><p>需要：<a href="http://%E4%BB%8Ehttp://www.paterva.com/web6/products/download.php">从http://www.paterva.com/web6/products/download.php</a>下载Matlego。</p><p>从 <a href="https://static.Shodan.io/downloads/Shodan-maltego-entities.mtz">https://static.Shodan.io/downloads/Shodan-maltego-entities.mtz</a></p><p>下载Shodan的matlego目录</p><p>用法：</p><pre><code>1.安装maltego之后，选择‘Manage tab’里的 ‘Manage Entities’ ，然后选择‘import’。
2.选择 ‘transforms’ 然后是‘advanced’  
</code></pre><p><img alt="enter image description here" img-src="11656fa07d9defb87c9787191e353d7e1d6dae31.jpg"></p><pre><code>3.现在可以添加Shodan的链接https://cetas.paterva.com/TDS/runner/showseed/Shodan  
</code></pre><p><img alt="enter image description here" img-src="a047ba5e0895800f3cfab506a27a3eb73c44b60e.jpg"></p><pre><code>4.最后我们可以看到安装成功的窗口
</code></pre><p><img alt="enter image description here" img-src="f73f596ec348195b9d4c926a4878e18d257cf7ba.jpg"></p><p>注意：需要你有Shodan的API keys，可以在maltgo进行Shodan的使用，API keys在你登陆Shodan账户时候是可以获得的。</p><h3>2.和metasploit的结合</h3><p>用法：</p><pre><code>1.在Kail/Backtrack Box中打开Metasploit framework
</code></pre><p><img alt="enter image description here" img-src="1b8ce33f839433011cb2ca0dc5ca3437794fa006.jpg"></p><pre><code>2.在命令行中输入show auxiliary
</code></pre><p><img alt="enter image description here" img-src="33cd7f1ffa53b99d6e985f3b88ce557adca53f15.jpg"></p><pre><code>3.使用 auxiliary/gather/Shodansearch 模块
</code></pre><p><img alt="enter image description here" img-src="f3499db57fdba45be4f280658e3aa6ea3e372cff.jpg"></p><pre><code>4.现在，你可以用show options命令来查看模块需要的参数
</code></pre><p><img alt="enter image description here" img-src="1b005d483dd056366dc54246bc02f3e35f099a70.jpg"></p><pre><code>5.我们需要指定iis来搜索iis服务器，还需要登陆Shodan账户后得到的API key。现在我们可以用Run command 来执行命令。
</code></pre><p><img alt="enter image description here" img-src="21d15ca26fcbc31cd67de712ead288bb5832473b.jpg"></p><p><img alt="enter image description here" img-src="c88b6badbdfd3a9aceaedbee7c92c9e78402cc65.jpg"></p><p>一般来说 auxiliary/gather/Shodan_search模块通过API向数据库查询前50个ip 地址。50个ip地址的限制可以通过购买无限制API key来扩大到查询10000个ip地址</p><h2>0x04 Shodan的组件</h2><hr><p>1.Exploits：Shodan Exploits 能够用于在ExploitDB 或Metasploit寻找针对不同系统、服务器、平台、应用的的exploits。</p><p><img alt="enter image description here" img-src="4f49fc0c14d3da7f4421c102bb0eaaf636aa757c.jpg"></p><p>2.Maps：这是个付费功能，我们能在地图上直观地看到Shodan提供的结果。提供三种视图：卫星，街景（浅），街景（深）。可以同时在屏幕展示超过1000个结果。</p><p><img alt="enter image description here" img-src="c23958e2e7df6c823b3555ab5a54a5197b24ad21.jpg"></p><p>3.)Scanhub：Shodan Scanhubs可以用于创建陌生网络的搜索，它支持Nmap 和 Masscan类似的工具。要使用Scanhub，我们首先要设置好工具，输出一个XML格式的文件并上传到Scanhub的库里以获得结果。不幸的是这也是一个付费功能。</p><h2>0x05 一些测试的例子</h2><hr><h3>1. Netgear设备</h3><p><img alt="enter image description here" img-src="e432a192860125e8556b75a79ca299dea14b8459.jpg"></p><h3>2. 网络摄像头</h3><p><img alt="enter link description here" img-src="534f3fc98ca4f19444f588c7c4a3f4bdd0fd7006.jpg"></p><h3>3. 比特币服务器</h3><p><img alt="enter image description here" img-src="760398b4bb0284200b24dbe4afb28d8ada9a902e.jpg"></p><h3>4. Ruby on Rails Vulnerable Server(CVE-2013-0156 and CVE-2013-0155)</h3><p><img alt="enter image description here" img-src="f45c3b5a3b2b4a92a02172141c3f318f6b676bcd.jpg"></p><h3>5. Windfarms:</h3><p><img alt="enter image description here" img-src="29b8d56be6036b05a65561760a396c9f61d4f018.jpg"></p><h3>6. DNS 服务:</h3><p><img alt="enter image description here" img-src="c1d4d9b7ac6da40a4237162e3d52fb5594065211.jpg"></p><h2>0x06 一些另外的cheat sheet 链接</h2><hr><p>http://www.Shodanhq.com/?q=bitcoin-mining-proxy (Bitcoin proxy mining) http://www.Shodanhq.com/search?q=port%3A11 (Systat) http://www.Shodanhq.com/search?q=port%3A8089+splunkd (Splunk servers on tcp/8089) http://www.Shodanhq.com/search?q=port%3A17(Search for quote of the day) http://www.Shodanhq.com/search?q=port%3A123(Ntp monlist) http://www.Shodanhq.com/search?q=port%3A5632 (Vnc) http://www.Shodanhq.com/search?q=port%3A1434 ((MS-SQL (1434)) http://www.Shodanhq.com/search?q=OpenSSL%2F1.0.1 (Servers running OpenSSL/1.0.1) http://www.Shodanhq.com/search?q=port%3A79 (Finger protocol) http://www.Shodanhq.com/search?q=port%3A15 (Netstat) http://www.Shodanhq.com/?q=telemetry+gateway (Telemetry gateway)<br>http://www.Shodanhq.com/?q=port:161+country:US+simatic (Simatic automation system o 161 running in US)</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0h1in9e</span> <span class="reply-time">2016-04-15 17:06:18</span></div><p></p><p>bucuo</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Neo_Nick</span> <span class="reply-time">2015-11-09 07:01:21</span></div><p></p><p>牛逼 我操 牛逼</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">x-star</span> <span class="reply-time">2014-07-14 17:42:33</span></div><p></p><p>请教shodanhq的搜索结果　在网页上都是模糊的　　看不到实际的东西　　请教这个怎么破？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">黄小昏</span> <span class="reply-time">2014-07-12 13:03:53</span></div><p></p><p>吓尿了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">从容</span> <span class="reply-time">2014-07-05 23:06:40</span></div><p></p><p>自从有了黑阔，我就再也不相信网络上有付费的东西...</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">竹</span> <span class="reply-time">2014-07-02 12:03:57</span></div><p></p><p>不是有网页版吗</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Knight</span> <span class="reply-time">2014-07-01 15:50:50</span></div><p></p><p>不信没破解。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">知道创宇-小号</span> <span class="reply-time">2014-07-01 10:52:19</span></div><p></p><p>port:8080<br>port:8088<br>大家自己看效果....囧</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">test</span> <span class="reply-time">2014-07-01 10:17:04</span></div><p></p><p>= = 你也可以</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">动后河</span> <span class="reply-time">2014-07-01 08:14:08</span></div><p></p><p>珍稀的测试帐号出现了！</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">test</span> <span class="reply-time">2014-06-30 15:58:05</span></div><p></p><p>让我想起了知道创宇的 钟馗之眼</p><p></p></div></div></div></div></div></main>